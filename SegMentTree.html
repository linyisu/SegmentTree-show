<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>çº¿æ®µæ ‘å…¨æ–¹ä½ä»‹ç»</title>  
  <style>    /* é»˜è®¤ä¸»é¢˜ - ç™½å¤©æ¨¡å¼ */
    :root {
      --primary-color: #5a67d8; /* Slightly darker for better contrast */
      --secondary-color: #7c3aed; /* Adjusted for vibrancy */
      --accent-color: #ec4899;
      --success-bg: linear-gradient(135deg, #10b981, #059669);
      --warning-bg: linear-gradient(135deg, #f59e0b, #d97706);
      --error-bg: linear-gradient(135deg, #ef4444, #dc2626);
      --header-bg: linear-gradient(135deg, #1e293b, #334155);
      --card-bg: rgba(255, 255, 255, 0.95);
      --card-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.12);
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-white: #ffffff;
      --body-bg: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
      --nav-bg: rgba(255, 255, 255, 0.95);
      --input-bg: #ffffff;
      --input-border: rgba(99, 102, 241, 0.2);
      --input-text: #0f172a;
      --focus-shadow: rgba(99, 102, 241, 0.15);
      --footer-text: rgba(15, 23, 42, 0.8);
      --footer-bg: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(241, 245, 249, 0.6));
      --code-bg: linear-gradient(135deg, #f8fafc, #f1f5f9);
      --code-text: #334155;
      --nav-button-bg: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(139, 92, 246, 0.08));
      --nav-button-text: #0f172a;
      --nav-button-hover-bg: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(139, 92, 246, 0.12));
      --border-radius: 20px;
      --font-size-base: 15px; /* Increased by 1px */
      --line-height-base: 1.6;
    }    /* é»‘å¤œæ¨¡å¼ */
    [data-theme="dark"] {
      --primary-color: #7c3aed; /* Brighter for better contrast */
      --secondary-color: #9f7aea; /* Lighter for readability */
      --accent-color: #f472b6;
      --header-bg: linear-gradient(135deg, #0f172a, #1e293b);
      --card-bg: rgba(15, 23, 42, 0.95);
      --card-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      --text-primary: #f1f5f9;
      --text-secondary: #cbd5e1;
      --text-white: #ffffff;
      --body-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      --nav-bg: rgba(15, 23, 42, 0.95);
      --input-bg: rgba(30, 41, 59, 0.8);
      --input-border: rgba(139, 92, 246, 0.3);
      --input-text: #f1f5f9;
      --focus-shadow: rgba(139, 92, 246, 0.25);
      --footer-text: rgba(241, 245, 249, 0.9);
      --footer-bg: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      --code-bg: linear-gradient(135deg, #0c1222, #0f172a);
      --code-text: #e2e8f0;
      --nav-button-bg: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      --nav-button-text: #cbd5e1;
      --nav-button-hover-bg: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.8));
    }    /* æŠ¤çœ¼æ¨¡å¼ */
    [data-theme="eye-care"] {
      --primary-color: #059669; /* Kept vibrant */
      --secondary-color: #047857;
      --accent-color: #0891b2;
      --header-bg: linear-gradient(135deg, #064e3b, #065f46);
      --card-bg: rgba(240, 253, 244, 0.95);
      --card-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.08);
      --text-primary: #064e3b;
      --text-secondary: #047857;
      --text-white: #ffffff;
      --body-bg: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #d1fae5 100%);
      --nav-bg: rgba(240, 253, 244, 0.95);
      --input-bg: rgba(255, 255, 255, 0.9);
      --input-border: rgba(5, 150, 105, 0.25);
      --input-text: #064e3b;
      --focus-shadow: rgba(5, 150, 105, 0.15);
      --footer-text: rgba(6, 78, 59, 0.85);
      --footer-bg: linear-gradient(135deg, rgba(240, 253, 244, 0.8), rgba(236, 253, 245, 0.6));
      --code-bg: linear-gradient(135deg, #f0fdf4, #ecfdf5);
      --code-text: #065f46;
      --nav-button-bg: linear-gradient(135deg, rgba(240, 253, 244, 0.8), rgba(236, 253, 245, 0.6));
      --nav-button-text: #047857;
      --nav-button-hover-bg: linear-gradient(135deg, rgba(240, 253, 244, 0.9), rgba(236, 253, 245, 0.8));
    }
    body {
      margin: 0;
      font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
      background: var(--body-bg);
      min-width: 800px;
      position: relative;
      transition: all 0.3s ease;
      font-size: var(--font-size-base); /* Increased by 1px */
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
      z-index: -1;
    }      
    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: var(--header-bg);
      color: var(--text-white);
      padding: 20px;
      text-align: center;
      font-size: 33px; /* Increased by 1px */
      font-weight: 700;
      z-index: 1000;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      letter-spacing: 1px;
      background-attachment: fixed;
    }
    header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }      nav {
      margin-top: 85px;
      width: 280px;
      min-width: 280px;
      max-width: 280px;
      flex-shrink: 0;
      background: var(--nav-bg);
      backdrop-filter: blur(20px);
      padding: 25px;
      box-shadow: 4px 0 30px rgba(0, 0, 0, 0.12);
      overflow-y: auto;
      border-radius: 0 var(--border-radius) var(--border-radius) 0;
      box-sizing: border-box;
      border-right: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }    .btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: var(--text-white);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 15px; /* Increased by 1px */
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      text-transform: none;
      letter-spacing: 0.5px;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    .btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 25px rgba(108, 92, 231, 0.4);
    }
    .btn:hover::before {
      left: 100%;
    }
    .btn:active {
      transform: translateY(-1px) scale(0.98);
    }    nav button {
      display: block;
      width: 100%;
      min-width: 220px;
      margin: 15px 0;
      padding: 16px 20px;
      text-align: left;
      font-size: 16px; /* Increased by 1px */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      border-radius: 15px;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: var(--nav-button-bg);
      color: var(--nav-button-text);
      border: 2px solid transparent;
    }
    nav button::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: var(--primary-color);
      transform: scaleY(0);
      transition: transform 0.3s ease;
      border-radius: 0 2px 2px 0;
    }    nav button:hover {
      background: var(--nav-button-hover-bg);
      transform: translateX(5px);
      border-color: rgba(108, 92, 231, 0.3);
    }
    nav button:hover::before {
      transform: scaleY(1);
    }    nav button.active {
      background: var(--success-bg);
      color: var(--text-white);
      box-shadow: 0 8px 20px rgba(0, 184, 148, 0.3);
      border-color: rgba(255, 255, 255, 0.3);
    }
    nav button.active::before {
      background: rgba(255, 255, 255, 0.8);
      transform: scaleY(1);
    }   
    main {
      flex-grow: 1;
      margin-top: 85px;
      padding: 30px;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.05);
      position: relative;
    }
    main::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 70% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 30% 70%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }
    main > * {
      position: relative;
      z-index: 1;
    }
    section {
      display: none;
    }
    section.active {
      display: block;
    }
    .card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      padding: 35px;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      margin-bottom: 30px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    .card h2 {
      color: var(--text-primary);
      margin-bottom: 25px;
      font-size: 29px; /* Increased by 1px */
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
    }
    .card h3 {
      color: var(--text-secondary);
      margin: 25px 0 18px 0;
      font-size: 21px; /* Increased by 1px */
      font-weight: 600;
      position: relative;
      padding-left: 20px;
    }
    .card h3::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 20px;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }
    .card p {
      line-height: 1.9;
      color: var(--text-primary);
      margin-bottom: 18px;
      font-size: 17px; /* Increased by 1px */
      font-weight: 400;
    }    .code-block {
      background: var(--code-bg);
      color: var(--code-text);
      padding: 25px;
      border-radius: 16px;
      margin: 25px 0;
      overflow-x: auto;
      font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
      font-size: 15px; /* Increased by 1px */
      line-height: 1.7;
      box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 10px 30px rgba(0, 0, 0, 0.2);
      white-space: pre-wrap;
      word-wrap: break-word;
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
      /* é»‘å¤œæ¨¡å¼ä¸‹çš„ä»£ç å—ç‰¹æ®Šå¤„ç† */
    [data-theme="dark"] .code-block {
      background: linear-gradient(135deg, #0a0f1c, #0c1222) !important;
      color: #f1f5f9 !important; /* High contrast white */
      border: 1px solid rgba(139, 92, 246, 0.2);
      box-shadow: 
        inset 0 1px 0 rgba(139, 92, 246, 0.1),
        0 15px 35px rgba(0, 0, 0, 0.4);
    }
    
    /* ç™½å¤©æ¨¡å¼ä¸‹çš„ä»£ç å—ç‰¹æ®Šå¤„ç† */
    [data-theme="light"] .code-block {
      background: linear-gradient(135deg, #ffffff, #f8fafc) !important;
      color: #1e293b !important; /* Darker for better contrast */
      border: 1px solid rgba(99, 102, 241, 0.15);
      box-shadow: 
        inset 0 1px 0 rgba(99, 102, 241, 0.05),
        0 10px 25px rgba(0, 0, 0, 0.08);
    }
    
    /* æŠ¤çœ¼æ¨¡å¼ä¸‹çš„ä»£ç å—ç‰¹æ®Šå¤„ç† */
    [data-theme="eye-care"] .code-block {
      background: linear-gradient(135deg, #f0fdf4, #ecfdf5) !important;
      color: #064e3b !important; /* Darker green for contrast */
      border: 1px solid rgba(5, 150, 105, 0.2);
      box-shadow: 
        inset 0 1px 0 rgba(5, 150, 105, 0.1),
        0 10px 25px rgba(0, 0, 0, 0.06);
    }
    .code-block::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      border-radius: 16px 16px 0 0;
    }
    .code-block::after {
      content: '{ }';
      position: absolute;
      top: 15px;
      right: 20px;
      color: rgba(255, 255, 255, 0.3);
      font-size: 19px; /* Increased by 1px */
      font-weight: bold;    }

    /* ===== è¯­æ³•é«˜äº®æ ·å¼ - ç°ä»£åŒ–é…è‰²æ–¹æ¡ˆ ===== */
    /* Dark ä¸»é¢˜ - Monokai é…è‰² */
    .code-block .keyword, .code-block code .keyword { color: #f92672; font-weight: 600; }
    .code-block .type, .code-block code .type { color: #66d9ef; font-weight: 600; }
    .code-block .function, .code-block code .function { color: #a6e22e; font-weight: 500; }
    .code-block .variable, .code-block code .variable { color: #fd971f; font-weight: 400; }
    .code-block .string, .code-block code .string { color: #e6db74; }
    .code-block .comment, .code-block code .comment { color: #75715e; opacity: 0.8; }
    .code-block .number, .code-block code .number { color: #ae81ff; }
    .code-block .operator, .code-block code .operator { color: #f92672; font-weight: 600; }
    .code-block .bracket, .code-block code .bracket { color: #f8f8f2; font-weight: 500; }
    .code-block .symbol, .code-block code .symbol { color: #66d9ef; font-weight: 500; }
    .code-block .pointer, .code-block code .pointer { color: #fd971f; font-weight: 600; }
    .code-block .preprocessor, .code-block code .preprocessor { color: #ae81ff; font-weight: 600; }
    .code-block .constant, .code-block code .constant { color: #ae81ff; font-weight: 600; }
    .code-block .namespace, .code-block code .namespace { color: #66d9ef; font-weight: 600; }
    /* Light ä¸»é¢˜ - GitHub Light é…è‰² */
    [data-theme="light"] .code-block .keyword, [data-theme="light"] .code-block code .keyword { color: #d73a49; font-weight: 600; }
    [data-theme="light"] .code-block .type, [data-theme="light"] .code-block code .type { color: #005cc5; font-weight: 600; }
    [data-theme="light"] .code-block .function, [data-theme="light"] .code-block code .function { color: #6f42c1; font-weight: 500; }
    [data-theme="light"] .code-block .variable, [data-theme="light"] .code-block code .variable { color: #e36209; font-weight: 400; }
    [data-theme="light"] .code-block .string, [data-theme="light"] .code-block code .string { color: #032f62; }
    [data-theme="light"] .code-block .comment, [data-theme="light"] .code-block code .comment { color: #6a737d; opacity: 0.8; }
    [data-theme="light"] .code-block .number, [data-theme="light"] .code-block code .number { color: #005cc5; }
    [data-theme="light"] .code-block .operator, [data-theme="light"] .code-block code .operator { color: #d73a49; font-weight: 600; }
    [data-theme="light"] .code-block .bracket, [data-theme="light"] .code-block code .bracket { color: #24292e; font-weight: normal; }
    [data-theme="light"] .code-block .symbol, [data-theme="light"] .code-block code .symbol { color: #e36209; font-weight: 500; }
    [data-theme="light"] .code-block .pointer, [data-theme="light"] .code-block code .pointer { color: #6f42c1; font-weight: 600; }
    [data-theme="light"] .code-block .preprocessor, [data-theme="light"] .code-block code .preprocessor { color: #d73a49; font-weight: 600; }
    [data-theme="light"] .code-block .constant, [data-theme="light"] .code-block code .constant { color: #6f42c1; font-weight: 600; }
    [data-theme="light"] .code-block .namespace, [data-theme="light"] .code-block code .namespace { color: #005cc5; font-weight: 600; }
    /* Eye-care ä¸»é¢˜ - Solarized Light é…è‰² */
    [data-theme="eye-care"] .code-block .keyword, [data-theme="eye-care"] .code-block code .keyword { color: #859900; font-weight: 600; }
    [data-theme="eye-care"] .code-block .type, [data-theme="eye-care"] .code-block code .type { color: #268bd2; font-weight: 600; }
    [data-theme="eye-care"] .code-block .function, [data-theme="eye-care"] .code-block code .function { color: #268bd2; font-weight: 500; }
    [data-theme="eye-care"] .code-block .variable, [data-theme="eye-care"] .code-block code .variable { color: #cb4b16; font-weight: 400; }
    [data-theme="eye-care"] .code-block .string, [data-theme="eye-care"] .code-block code .string { color: #2aa198; }
    [data-theme="eye-care"] .code-block .comment, [data-theme="eye-care"] .code-block code .comment { color: #93a1a1; opacity: 0.8; }
    [data-theme="eye-care"] .code-block .number, [data-theme="eye-care"] .code-block code .number { color: #d33682; }
    [data-theme="eye-care"] .code-block .operator, [data-theme="eye-care"] .code-block code .operator { color: #dc322f; font-weight: 600; }
    [data-theme="eye-care"] .code-block .bracket, [data-theme="eye-care"] .code-block code .bracket { color: #586e75; font-weight: normal; }
    [data-theme="eye-care"] .code-block .symbol, [data-theme="eye-care"] .code-block code .symbol { color: #6c71c4; font-weight: 500; }
    [data-theme="eye-care"] .code-block .pointer, [data-theme="eye-care"] .code-block code .pointer { color: #b58900; font-weight: 600; }
    [data-theme="eye-care"] .code-block .preprocessor, [data-theme="eye-care"] .code-block code .preprocessor { color: #dc322f; font-weight: 600; }
    [data-theme="eye-care"] .code-block .constant, [data-theme="eye-care"] .code-block code .constant { color: #6c71c4; font-weight: 600; }
    [data-theme="eye-care"] .code-block .namespace, [data-theme="eye-care"] .code-block code .namespace { color: #268bd2; font-weight: 600; }
    .settings-panel {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 18px;
      margin-bottom: 25px;
      border: 2px solid rgba(108, 92, 231, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }
    .settings-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    .settings-row {
      display: flex;
      align-items: center;
      margin: 18px 0;
      gap: 18px;
    }
    .settings-row label {
      font-weight: 600;
      color: var(--text-primary);
      min-width: 140px;
      font-size: 15px;
    }    .settings-row input, .settings-row select {
      padding: 12px 16px;
      border: 2px solid var(--input-border);
      border-radius: 12px;
      background: var(--input-bg);
      color: var(--input-text);
      transition: all 0.3s ease;
      font-size: 14px;
    }
    .settings-row input:focus, .settings-row select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px var(--focus-shadow);
      transform: translateY(-1px);
    }
    #tree-container {
      margin-top: 30px;
      padding: 25px;
      background: var(--card-bg);
      border-radius: 18px;
      border-left: 5px solid var(--primary-color);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: visible;
      min-height: 200px; /* é™ä½æœ€å°é«˜åº¦ */
    }
    #tree-container::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 100px;
      height: 100px;
      background: radial-gradient(circle, rgba(108, 92, 231, 0.1) 0%, transparent 70%);
      border-radius: 50%;
    }
    
    #tree-container h4 {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 20px;
      font-size: 18px;
      font-weight: 600;
    }
    
    #tree-container p {
      text-align: center;
      margin-bottom: 25px;
      padding: 10px;
      background: rgba(108, 92, 231, 0.1);
      border-radius: 8px;
      border-left: 3px solid var(--primary-color);
    }    /* çœŸæ­£çš„æ ‘å½¢å¯è§†åŒ–æ ·å¼ */    
    .tree-visual {
      width: 100%; /* æ”¹ä¸º100%è‡ªé€‚åº”å®½åº¦ */
      overflow: hidden; /* ç¡®ä¿å†…å®¹ä¸æº¢å‡º */
      padding: 30px 25px; /* å¢åŠ ä¸Šä¸‹å†…è¾¹è·ï¼Œå·¦å³ä¿æŒ25px */
      position: relative;
      box-sizing: border-box; /* åŒ…å«paddingåœ¨å®½åº¦è®¡ç®—å†… */
      min-height: 400px; /* å¢åŠ æœ€å°é«˜åº¦ */
    }
    .tree-level {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 18px 0;
      position: relative;
      width: 100%;
      padding: 0;
      min-height: 50px;
    }
    
    .tree-level-0, .tree-level-1, .tree-level-2, .tree-level-3 {
      margin: 18px 0;
      display: flex;
      width: 100%;
    }

    .tree-node {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      height: 35px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(108, 92, 231, 0.3);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: absolute;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.3);
      word-wrap: break-word;
      font-size: 10px;
      line-height: 1.2;
      z-index: 2;
      backdrop-filter: blur(3px);
      white-space: pre-line;
      box-sizing: border-box;
    }
    .tree-node.depth-0 {
      background: linear-gradient(135deg, #6c5ce7, #a29bfe);
      height: 40px;
      font-size: 11px;
      font-weight: 700;
      box-shadow: 0 6px 16px rgba(108, 92, 231, 0.4);
    }
    
    .tree-node.depth-1 {
      background: linear-gradient(135deg, #fd79a8, #e84393);
      height: 35px;
      font-size: 10px;
      box-shadow: 0 5px 14px rgba(253, 121, 168, 0.3);
    }
    
    .tree-node.depth-2 {
      background: linear-gradient(135deg, #00b894, #00cec9);
      height: 35px;
      font-size: 10px;
      box-shadow: 0 4px 12px rgba(0, 184, 148, 0.3);
    }
    
    .tree-node.depth-3 {
      background: linear-gradient(135deg, #fdcb6e, #e17055);
      height: 35px;
      font-size: 9px;
      box-shadow: 0 3px 10px rgba(253, 203, 110, 0.3);
    }
    /* è¿æ¥çº¿æ ·å¼ */
    .tree-connection {
      position: absolute;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      z-index: 1;
    }
    
    .tree-connection.vertical {
      width: 2px;
      top: -25px;
      height: 25px;
    }
    
    .tree-connection.horizontal {
      height: 2px;
      top: -25px;
    }
    
    .tree-connection-line {
      opacity: 0;
      animation: fadeInLine 0.5s ease-in-out 0.3s forwards;
    }
    @keyframes fadeInLine {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    
    .tree-node::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.6s ease;
    }
    
    .tree-node:hover::before {
      left: 100%;
    }
    .tree-node:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }
    
    /* ç®€åŒ–çš„èŠ‚ç‚¹å‡ºç°åŠ¨ç”» - åªæ”¹å˜é€æ˜åº¦å’Œè½»å¾®ä½ç§» */
    .tree-node {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .quiz-question {
      margin: 25px 0;
      padding: 25px;
      background: linear-gradient(135deg, rgba(108, 92, 231, 0.1), rgba(162, 155, 254, 0.05));
      border-radius: 16px;
      border-left: 5px solid var(--primary-color);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
      position: relative;
      overflow: hidden;
    }
    .quiz-question::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 60px;
      height: 60px;
      background: radial-gradient(circle, rgba(108, 92, 231, 0.15) 0%, transparent 70%);
      border-radius: 50%;
    }
    .quiz-options label {
      display: block;
      margin: 6px 0;
      cursor: pointer;
      padding: 10px 14px;
      border-radius: 10px;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      background: rgba(255, 255, 255, 0.5);
      position: relative;
      overflow: hidden;
    }
    .quiz-options label::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: var(--primary-color);
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }
    .quiz-options label:hover {
      background: rgba(108, 92, 231, 0.1);
      border-color: rgba(108, 92, 231, 0.3);
      transform: translateX(5px);
    }
    .quiz-options label:hover::before {
      transform: scaleY(1);
    }
    .quiz-result {
      margin-top: 25px;
      padding: 20px;
      border-radius: 16px;
      display: none;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }    footer {
      margin-top: 50px;
      font-size: 15px;
      color: var(--footer-text);
      text-align: center;
      padding: 25px;
      background: var(--footer-bg);
      border-radius: 18px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }
    /* æ·»åŠ æ»šåŠ¨æ¡ç¾åŒ– */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
    }
    /* æ·»åŠ ç„¦ç‚¹æ ·å¼ */
    .btn:focus,
    nav button:focus,
    input:focus,
    select:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }
    /* æ·»åŠ å“åº”å¼ä¼˜åŒ– */
    @media (max-width: 1200px) {
      nav {
        width: 250px;
        min-width: 250px;
        max-width: 250px;
      }
      nav button {
        min-width: 200px;
        font-size: 14px;
        padding: 14px 18px;
      }
      .card h2 {
        font-size: 24px;
      }
      .card h3 {
        font-size: 18px;
      }
    .tree-visual {
        width: 100%;
        overflow: hidden;
        padding: 30px 25px;
        position: relative;
        box-sizing: border-box;
        min-height: 200px; /* é™ä½æœ€å°é«˜åº¦ */
      }
    }
    
    /* ä¸‰çº§ä¸»é¢˜å¼€å…³æ ·å¼ */    .theme-switcher {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10000;
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 25px;
      padding: 8px;
      box-shadow: var(--card-shadow);
      border: 2px solid rgba(99, 102, 241, 0.15);
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.3s ease;
    }

    .theme-switcher:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .theme-option {
      width: 44px;
      height: 44px;
      border-radius: 22px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      position: relative;
      background: transparent;
      backdrop-filter: blur(10px);
    }

    .theme-option:hover {
      transform: scale(1.1);
      border-color: rgba(255, 255, 255, 0.3);
    }

    .theme-option.active {
      transform: scale(1.15);
      border-color: var(--primary-color);
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.3);
    }

    .theme-option[data-theme="light"] {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #92400e;
    }

    .theme-option[data-theme="dark"] {
      background: linear-gradient(135deg, #374151, #1f2937);
      color: #f3f4f6;
    }

    .theme-option[data-theme="eye-care"] {
      background: linear-gradient(135deg, #10b981, #059669);
      color: #ffffff;
    }

    .theme-option.active[data-theme="light"] {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #92400e;
      box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
    }

    .theme-option.active[data-theme="dark"] {
      background: linear-gradient(135deg, #374151, #1f2937);
      color: #f3f4f6;
      box-shadow: 0 6px 20px rgba(55, 65, 81, 0.6);
    }

    .theme-option.active[data-theme="eye-care"] {
      background: linear-gradient(135deg, #10b981, #059669);
      color: #ffffff;
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    .theme-option.active[data-theme="dark"] {
      background: linear-gradient(135deg, #2d3748, #4a5568);
      color: #e2e8f0;
    }

    .theme-option.active[data-theme="eye-care"] {
      background: linear-gradient(135deg, #68d391, #38b2ac);
      color: #2d3748;
    }
  </style>
</head>
<body>
  <!-- ä¸‰çº§ä¸»é¢˜å¼€å…³ -->
  <div class="theme-switcher">
    <button class="theme-option active" data-theme="light" onclick="switchTheme('light')" title="ç™½å¤©æ¨¡å¼">â˜€ï¸</button>
    <button class="theme-option" data-theme="eye-care" onclick="switchTheme('eye-care')" title="æŠ¤çœ¼æ¨¡å¼">ğŸŒ¿</button>
    <button class="theme-option" data-theme="dark" onclick="switchTheme('dark')" title="é»‘å¤œæ¨¡å¼">ğŸŒ™</button>
  </div>

  <header>ğŸŒ² çº¿æ®µæ ‘å…¨æ–¹ä½ä»‹ç»ï¼ˆä»å…¥é—¨åˆ°å…¥åœŸï¼‰</header>

  <nav>
    <button class="nav-btn active" onclick="showSection('intro')" aria-label="çº¿æ®µæ ‘ç®€ä»‹">ğŸ“š çº¿æ®µæ ‘ç®€ä»‹</button>
    <button class="nav-btn" onclick="showSection('basic')" aria-label="åŸºæœ¬æ“ä½œ">ğŸ”§ åŸºæœ¬æ“ä½œ</button>
    <button class="nav-btn" onclick="showSection('advanced')" aria-label="é«˜çº§æŠ€å·§">ğŸš€ é«˜çº§æŠ€å·§</button>
    <button class="nav-btn" onclick="showSection('quiz')" aria-label="äº’åŠ¨æµ‹è¯•">ğŸ¯ äº’åŠ¨æµ‹è¯•</button>
    <button class="nav-btn" onclick="showSection('settings')" aria-label="è‡ªå®šä¹‰è®¾ç½®">âš™ï¸ è‡ªå®šä¹‰è®¾ç½®</button>
  </nav>

  <main>
    <section id="intro" class="active">
      <div class="card">
        <h2>ğŸŒ³ ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ</h2>
        <p>çº¿æ®µæ ‘(Segment Tree)æ˜¯ä¸€ä¸ªèƒ½å¤Ÿé«˜æ•ˆå¤„ç†åŒºé—´æŸ¥è¯¢å’Œæ›´æ–°çš„æ•°æ®ç»“æ„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O(log n)</strong>ï¼Œé€‚ç”¨äºé™æ€æˆ–åŠ¨æ€æ•°ç»„ã€‚</p>
        <p>å®ƒä»¥äºŒå‰æ ‘çš„å½¢å¼é€’å½’åˆ’åˆ†åŒºé—´ï¼Œç›´åˆ°æ¯ä¸ªæ®µè¡¨ç¤ºå•ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªåŒºé—´ã€‚</p>
        <h3>ğŸ“Š çº¿æ®µæ ‘å¯ç»´æŠ¤çš„åŒºé—´ä¿¡æ¯</h3>
        <p>â€¢ <strong>åŒºé—´å’Œ</strong>ï¼šè®¡ç®—åŒºé—´å†…æ‰€æœ‰å…ƒç´ çš„æ€»å’Œ</p>
        <p>â€¢ <strong>åŒºé—´æœ€å€¼(RMQ)</strong>ï¼šæŸ¥è¯¢åŒºé—´å†…çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼</p>
        <p>â€¢ <strong>åŒºé—´GCD</strong>ï¼šè®¡ç®—åŒºé—´å†…æ‰€æœ‰æ•°çš„æœ€å¤§å…¬çº¦æ•°</p>
        <p>â€¢ <strong>åŒºé—´æœ€å¤§å­æ®µå’Œ</strong>ï¼šå¯»æ‰¾åŒºé—´å†…è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</p>
        <p>â€¢ <strong>åŒºé—´æœ€é•¿è¿ç»­ç›¸åŒå€¼æ®µ</strong>ï¼šç»Ÿè®¡ç›¸åŒå€¼çš„æœ€é•¿è¿ç»­é•¿åº¦</p>
        <p>â€¢ <strong>åŒºé—´æœ€é•¿é€’å¢/é€’å‡æ®µ</strong>ï¼šå¯»æ‰¾æœ€é•¿çš„å•è°ƒåºåˆ—</p>
        <p>â€¢ <strong>â€¦â€¦</strong></p>
        <h3>âš¡ çº¿æ®µæ ‘æ”¯æŒçš„åŒºé—´ä¿®æ”¹æ“ä½œ</h3>
        <p>â€¢ <strong>åŒºé—´åŠ æ³•</strong>ï¼šç»™åŒºé—´å†…æ‰€æœ‰å…ƒç´ åŠ ä¸ŠæŸä¸ªå€¼</p>
        <p>â€¢ <strong>åŒºé—´ä¹˜æ³•</strong>ï¼šç»™åŒºé—´å†…æ‰€æœ‰å…ƒç´ ä¹˜ä»¥æŸä¸ªå€¼</p>
        <p>â€¢ <strong>åŒºé—´èµ‹å€¼</strong>ï¼šå°†åŒºé—´å†…æ‰€æœ‰å…ƒç´ è®¾ä¸ºæŸä¸ªå€¼</p>
        <p>â€¢ <strong>åŒºé—´å¼‚æˆ–</strong>ï¼šå¯¹åŒºé—´å†…æ‰€æœ‰å…ƒç´ è¿›è¡Œå¼‚æˆ–æ“ä½œ</p>
        <p>â€¢ <strong>åŒºé—´å–å</strong>ï¼šå¯¹åŒºé—´å†…æ‰€æœ‰å…ƒç´ å–å</p>
        <p>â€¢ <strong>åŒºé—´æ‹¼æ¥</strong>ï¼šè¿æ¥å¤šä¸ªåŒºé—´</p>
        <p>â€¢ <strong>â€¦â€¦</strong></p>
      </div>
    </section>

    <section id="basic">
      <div class="card">
        <h2>ğŸ”§ çº¿æ®µæ ‘çš„æ„å»ºä¸æ“ä½œ</h2>
        <p>çº¿æ®µæ ‘çš„æ„å»ºé€šå¸¸é‡‡ç”¨é€’å½’æ–¹å¼ï¼Œæ ¹æ®åŒºé—´ä¸æ–­å¯¹åŠåˆ’åˆ†ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç¼–å· <code>u</code> è¡¨ç¤ºå½“å‰å¤„ç†çš„åŒºé—´ <code>[l, r]</code>ã€‚</p>
        <h3>ğŸ“ æ„å»ºå‡½æ•°è¯¦è§£</h3>
        <div class="code-block" id="build-code">void build(int l, int r, int u)
{
    if (l == r)
    {
        info[u] = Info(arr[l]);
        return;
    }
    
    int mid = (l + r) >> 1;
    build(l, mid, u << 1);
    build(mid + 1, r, u << 1 | 1);
    push_up(u);
}</div>
        <h3>ğŸ¯ æ„å»ºè¿‡ç¨‹å¯è§†åŒ–</h3>
        <div class="settings-row">
          <label>æ•°ç»„é•¿åº¦ n:</label>
          <input type="number" id="input-n" value="8" min="1" max="8" aria-label="è¾“å…¥æ•°ç»„é•¿åº¦" />
          <button class="btn" id="btn-build" aria-label="å¼€å§‹æ„å»ºçº¿æ®µæ ‘">ğŸš€ å¼€å§‹æ„å»º</button>
        </div>
        <div id="tree-container">
          <p>ç‚¹å‡»"å¼€å§‹æ„å»º"æŒ‰é’®æŸ¥çœ‹çº¿æ®µæ ‘æ„å»ºè¿‡ç¨‹</p>
        </div>
        <h3>ğŸ“š å…¶ä»–æ ¸å¿ƒæ“ä½œ</h3>
        <div class="code-block">// åŒºé—´æŸ¥è¯¢
Info query(int l, int r, int ql, int qr, int u)
{
    if (ql <= l && r <= qr)
        return info[u];
    
    int mid = (l + r) >> 1;
    Info res;
    if (ql <= mid)
        res = res + query(l, mid, ql, qr, u << 1);
    if (qr > mid)
        res = res + query(mid + 1, r, ql, qr, u << 1 | 1);
    return res;
}

// å•ç‚¹æ›´æ–°
void update(int l, int r, int pos, int val, int u)
{
    if (l == r)
    {
        info[u] = Info(val);
        return;
    }
    
    int mid = (l + r) >> 1;
    if (pos <= mid)
        update(l, mid, pos, val, u << 1);
    else
        update(mid + 1, r, pos, val, u << 1 | 1);
    push_up(u);
}</div>
      </div>
    </section>

    <section id="advanced">
      <div class="card">
        <h2>ğŸš€ è¿›é˜¶æŠ€å·§</h2>
        <h3>â° æ‡’æƒ°æ ‡è®° (Lazy Propagation)</h3>
        <p>æ‡’æƒ°æ ‡è®°æ˜¯çº¿æ®µæ ‘çš„é‡è¦ä¼˜åŒ–æŠ€æœ¯ï¼Œç”¨äºå¤„ç†åŒºé—´ä¿®æ”¹æ“ä½œï¼Œé¿å…æ¯æ¬¡éƒ½é€’å½’åˆ°å¶å­èŠ‚ç‚¹ã€‚</p>
        <div class="code-block">void push_down(int u, int l, int r)
{
    if (lazy[u] != 0)
    {
        int mid = (l + r) >> 1;
        lazy[u << 1] += lazy[u];
        lazy[u << 1 | 1] += lazy[u];
        info[u << 1].sum += lazy[u] * (mid - l + 1);
        info[u << 1 | 1].sum += lazy[u] * (r - mid);
        lazy[u] = 0;
    }
}

// åŒºé—´ä¿®æ”¹
void modify(int l, int r, int ql, int qr, int val, int u)
{
    if (ql <= l && r <= qr)
    {
        lazy[u] += val;
        info[u].sum += val * (r - l + 1);
        return;
    }
    
    push_down(u, l, r);
    int mid = (l + r) >> 1;
    if (ql <= mid)
        modify(l, mid, ql, qr, val, u << 1);
    if (qr > mid)
        modify(mid + 1, r, ql, qr, val, u << 1 | 1);
    push_up(u);
}</div>
        <h3>ğŸŒ å¯æŒä¹…åŒ–çº¿æ®µæ ‘</h3>
        <p>å¯æŒä¹…åŒ–çº¿æ®µæ ‘èƒ½å¤Ÿä¿å­˜æ•°æ®ç»“æ„çš„å†å²ç‰ˆæœ¬ï¼Œæ”¯æŒæŸ¥è¯¢ä»»æ„å†å²æ—¶åˆ»çš„çŠ¶æ€ã€‚</p>
        <div class="code-block">struct Node
{
    int sum, lc, rc;
} tree[MAXN];

int tot = 0;

int build(int l, int r)
{
    int u = ++tot;
    if (l == r)
    {
        tree[u].sum = a[l];
        return u;
    }
    
    int mid = (l + r) >> 1;
    tree[u].lc = build(l, mid);
    tree[u].rc = build(mid + 1, r);
    tree[u].sum = tree[tree[u].lc].sum + tree[tree[u].rc].sum;
    return u;
}

int update(int pre, int l, int r, int pos, int val)
{
    int u = ++tot;
    tree[u] = tree[pre];
    if (l == r)
    {
        tree[u].sum += val;
        return u;
    }
    
    int mid = (l + r) >> 1;
    if (pos <= mid)
        tree[u].lc = update(tree[pre].lc, l, mid, pos, val);
    else
        tree[u].rc = update(tree[pre].rc, mid + 1, r, pos, val);
    tree[u].sum = tree[tree[u].lc].sum + tree[tree[u].rc].sum;
    return u;
}
        </div>
        <h3>âš–ï¸ æƒå€¼çº¿æ®µæ ‘</h3>
        <p>æƒå€¼çº¿æ®µæ ‘ä»¥å€¼åŸŸä½œä¸ºä¸‹æ ‡å»ºæ ‘ï¼Œå¸¸ç”¨äºå¤„ç†ç¬¬kå°æ•°ã€æ•°å€¼ç»Ÿè®¡ç­‰é—®é¢˜ã€‚</p>
        <div class="code-block">
// æ’å…¥ä¸€ä¸ªæ•°å€¼
void insert(int l, int r, int val, int u)
{
    tree[u]++;
    if (l == r)
        return;
        
    int mid = (l + r) >> 1;
    if (val <= mid)
        insert(l, mid, val, u << 1);
    else
        insert(mid + 1, r, val, u << 1 | 1);
}

// æŸ¥è¯¢ç¬¬kå°çš„æ•°
int kth(int l, int r, int k, int u)
{
    if (l == r)
        return l;
        
    int mid = (l + r) >> 1;
    if (tree[u << 1] >= k)
        return kth(l, mid, k, u << 1);
    else
        return kth(mid + 1, r, k - tree[u << 1], u << 1 | 1);
}</div>
      </div>
    </section>

    <section id="quiz">
      <div class="card">
        <h2>ğŸ¯ äº’åŠ¨å°æµ‹</h2>
        <p>é€šè¿‡ä»¥ä¸‹é€‰æ‹©é¢˜æµ‹è¯•ä½ å¯¹çº¿æ®µæ ‘çš„ç†è§£ç¨‹åº¦ï¼</p>
        <div id="quiz-container">
          <div class="quiz-question">
            <h3>é—®é¢˜ 1: çº¿æ®µæ ‘çš„å•æ¬¡åŒºé—´æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ï¼Ÿ</h3>
            <div class="quiz-options">
              <label><input type="radio" name="q1" value="a" aria-label="é€‰é¡¹A: O(n)"> A. O(n)</label><br>
              <label><input type="radio" name="q1" value="b" aria-label="é€‰é¡¹B: O(log n)"> B. O(log n)</label><br>
              <label><input type="radio" name="q1" value="c" aria-label="é€‰é¡¹C: O(n log n)"> C. O(n log n)</label><br>
              <label><input type="radio" name="q1" value="d" aria-label="é€‰é¡¹D: O(nÂ²)"> D. O(nÂ²)</label>
            </div>
          </div>
          <div class="quiz-question">
            <h3>é—®é¢˜ 2: çº¿æ®µæ ‘çš„ç©ºé—´å¤æ‚åº¦é€šå¸¸æ˜¯ï¼Ÿ</h3>
            <div class="quiz-options">
              <label><input type="radio" name="q2" value="a" aria-label="é€‰é¡¹A: O(n)"> A. O(n)</label><br>
              <label><input type="radio" name="q2" value="b" aria-label="é€‰é¡¹B: O(2n)"> B. O(2n)</label><br>
              <label><input type="radio" name="q2" value="c" aria-label="é€‰é¡¹C: O(4n)"> C. O(4n)</label><br>
              <label><input type="radio" name="q2" value="d" aria-label="é€‰é¡¹D: O(n log n)"> D. O(n log n)</label>
            </div>
          </div>
          <div class="quiz-question">
            <h3>é—®é¢˜ 3: æ‡’æƒ°æ ‡è®°çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Ÿ</h3>
            <div class="quiz-options">
              <label><input type="radio" name="q3" value="a" aria-label="é€‰é¡¹A: å‡å°‘å†…å­˜ä½¿ç”¨"> A. å‡å°‘å†…å­˜ä½¿ç”¨</label><br>
              <label><input type="radio" name="q3" value="b" aria-label="é€‰é¡¹B: ä¼˜åŒ–åŒºé—´ä¿®æ”¹æ“ä½œ"> B. ä¼˜åŒ–åŒºé—´ä¿®æ”¹æ“ä½œ</label><br>
              <label><input type="radio" name="q3" value="c" aria-label="é€‰é¡¹C: ç®€åŒ–ä»£ç å®ç°"> C. ç®€åŒ–ä»£ç å®ç°</label><br>
              <label><input type="radio" name="q3" value="d" aria-label="é€‰é¡¹D: æé«˜æŸ¥è¯¢é€Ÿåº¦"> D. æé«˜æŸ¥è¯¢é€Ÿåº¦</label>
            </div>
          </div>
          <button class="btn" onclick="checkQuiz()" aria-label="æäº¤æµ‹è¯•ç­”æ¡ˆ">ğŸ“Š æäº¤ç­”æ¡ˆ</button>
          <div id="quiz-result" class="quiz-result"></div>
        </div>
      </div>
    </section>

    <section id="settings">
      <div class="card">
        <h2>âš™ï¸ è‡ªå®šä¹‰è®¾ç½®</h2>
        <div class="settings-panel">
          <div class="settings-row">
            <label>å­—ä½“å¤§å°:</label>
            <input type="range" id="font-size-slider" min="12" max="20" value="14" aria-label="è°ƒæ•´ä»£ç å­—ä½“å¤§å°">
            <span id="font-size-display">14px</span>
          </div>
          <div class="settings-row">
            <label>è¡Œé«˜:</label>
            <input type="range" id="line-height-slider" min="1.2" max="2.0" step="0.1" value="1.6" aria-label="è°ƒæ•´ä»£ç è¡Œé«˜">
            <span id="line-height-display">1.6</span>
          </div>
        </div>
        <div class="settings-panel">
          <h3>ğŸŒ² å¯è§†åŒ–è®¾ç½®</h3>
          <div class="settings-row">
            <label>åŠ¨ç”»é€Ÿåº¦:</label>
            <select id="animation-speed" aria-label="é€‰æ‹©åŠ¨ç”»é€Ÿåº¦">
              <option value="slow">ğŸŒ æ…¢é€Ÿ (2ç§’)</option>
              <option value="normal">ğŸš€ æ­£å¸¸ (1ç§’)</option>
              <option value="fast" selected>âš¡ å¿«é€Ÿ (0.5ç§’)</option>
            </select>
          </div>
          <div class="settings-row">
            <label>èŠ‚ç‚¹é¢œè‰²:</label>
            <input type="color" id="node-color" value="#74b9ff" aria-label="é€‰æ‹©èŠ‚ç‚¹é¢œè‰²">
            <button class="btn" onclick="applyNodeColor()" aria-label="åº”ç”¨èŠ‚ç‚¹é¢œè‰²">åº”ç”¨é¢œè‰²</button>
          </div>
          <div class="settings-row">
            <label>æ˜¾ç¤ºèŠ‚ç‚¹å€¼:</label>
            <input type="checkbox" id="show-values" checked aria-label="åˆ‡æ¢èŠ‚ç‚¹å€¼æ˜¾ç¤º">
          </div>
        </div>
        <div class="settings-panel">
          <h3>ğŸ’¾ å¯¼å‡ºè®¾ç½®</h3>
          <div class="settings-row">
            <button class="btn" onclick="exportSettings()" aria-label="å¯¼å‡ºé…ç½®">ğŸ“¤ å¯¼å‡ºé…ç½®</button>
            <button class="btn" onclick="resetSettings()" aria-label="é‡ç½®è®¾ç½®">ğŸ”„ é‡ç½®è®¾ç½®</button>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p>Â© 2025 çº¿æ®µæ ‘æ¢ç´¢è€… | ğŸŒŸ è®©æ•°æ®ç»“æ„å˜å¾—æœ‰è¶£ ğŸŒŸ</p>
    </footer>
  </main>
  <script>
    // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
    function switchTheme(theme) {
      // æ›´æ–°data-themeå±æ€§
      document.documentElement.setAttribute('data-theme', theme);
      
      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      document.querySelectorAll('.theme-option').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`[data-theme="${theme}"]`).classList.add('active');
      
      // ä¿å­˜åˆ°localStorage
      localStorage.setItem('theme', theme);
      
      // æ›´æ–°currentThemeå˜é‡
      currentTheme = theme;
    }

    // å…¨å±€å˜é‡
    let currentTheme = 'light'; // æ”¹ä¸ºé»˜è®¤lightä¸»é¢˜
    let currentFontSize = 14;
    let currentLineHeight = 1.6;
    let animationSpeed = 'fast';
    let nodeColor = '#74b9ff';
    let showValues = true;
    // ç¼“å­˜ DOM å…ƒç´ 
    const DOM = {
      fontSizeSlider: document.getElementById('font-size-slider'),
      fontSizeDisplay: document.getElementById('font-size-display'),
      lineHeightSlider: document.getElementById('line-height-slider'),
      lineHeightDisplay: document.getElementById('line-height-display'),
      animationSpeed: document.getElementById('animation-speed'),
      nodeColor: document.getElementById('node-color'),
      showValues: document.getElementById('show-values'),
      treeContainer: document.getElementById('tree-container'),
      quizResult: document.getElementById('quiz-result'),
      inputN: document.getElementById('input-n'),
      btnBuild: document.getElementById('btn-build')
    };

    // è¯­æ³•é«˜äº®è§„åˆ™
    const highlightRules = {
      keywords: ['void', 'int', 'if', 'else', 'for', 'while', 'do', 'return', 'struct', 'class', 'public', 'private', 
      'protected', 'const', 'static', 'bool', 'char', 'double', 'float', 'long', 'short', 'unsigned', 'signed', 'auto',
       'break', 'continue', 'switch', 'case', 'default', 'namespace', 'using', 'include', 'define', 'ifdef', 'ifndef', 'endif'],      types: ['Info', 'Node', 'vector', 'string', 'pair', 'map', 'set', 'queue', 'stack', 'priority_queue'],
      commentSingle: /(\/\/.*?)(\n|$)/g,
      commentMulti: /(\/\*[\s\S]*?\*\/)/g,
      strings: /("(?:[^"\\]|\\.)*")|('(?:[^'\\]|\\.)*')/g,
      numbers: /\b(\d+)\b/g,
      operators: /\b(<<|>>|<=|>=|==|!=|&&|\|\||[+\-*%=!&|^~<>/])\b/g,
      functions: /\b([a-zA-Z_][a-zA-Z0-9_]*)\s*(?=\()/g,
      brackets: /[()\\[\\]]/g // Modified: Excluded curly braces {}
    };    // C++ è¯­æ³•é«˜äº®å‡½æ•°
    function highlightCode(code) {      // ç¼“å­˜æ­£åˆ™è¡¨è¾¾å¼
      const regexCache = {
        escape: /[&<>]/g,
        commentSingle: highlightRules.commentSingle,
        commentMulti: highlightRules.commentMulti,
        strings: highlightRules.strings,
        numbers: highlightRules.numbers,
        operators: highlightRules.operators,
        brackets: highlightRules.brackets // Added brackets regex
      };

      // HTML è½¬ä¹‰æ˜ å°„
      const escapeMap = {
        '&': '&',
        '<': '<',
        '>': '>'
      };

      // è½¬ä¹‰ HTML ç‰¹æ®Šå­—ç¬¦
      code = code.replace(regexCache.escape, match => escapeMap[match]);

      let commentIndex = 0;
      const protectedComments = {};

      // ä¿æŠ¤å•è¡Œæ³¨é‡Š
      code = code.replace(regexCache.commentSingle, (match, comment, ending) => {
        const placeholder = `__COMMENT_${commentIndex}__`;
        protectedComments[commentIndex++] = `<span class="comment">${comment}</span>`;
        return placeholder + ending;
      });

      // ä¿æŠ¤å¤šè¡Œæ³¨é‡Š
      code = code.replace(regexCache.commentMulti, (match) => {
        const placeholder = `__COMMENT_${commentIndex}__`;
        protectedComments[commentIndex++] = `<span class="comment">${match}</span>`;
        return placeholder;
      });

      // é«˜äº®å­—ç¬¦ä¸²
      code = code.replace(regexCache.strings, '<span class="string">$1</span>');

      // é«˜äº®æ•°å­—
      code = code.replace(regexCache.numbers, '<span class="number">$1</span>');

      // é«˜äº®å…³é”®å­—
      highlightRules.keywords.forEach(keyword => {
        code = code.replace(new RegExp(`\\b${keyword}\\b(?![^<]*</span>)`, 'g'), `<span class="keyword">${keyword}</span>`);
      });

      // é«˜äº®ç±»å‹
      highlightRules.types.forEach(type => {
        code = code.replace(new RegExp(`\\b${type}\\b(?![^<]*</span>)`, 'g'), `<span class="type">${type}</span>`);
      });      // é«˜äº®å‡½æ•°å
      code = code.replace(highlightRules.functions, '<span class="function">$1</span>');
      
      // é«˜äº®å˜é‡å - æ”¹è¿›ç‰ˆï¼šè¯†åˆ«å‚æ•°ã€èµ‹å€¼è¯­å¥å’Œç®€å•å£°æ˜ä¸­çš„å˜é‡
      function isKeywordOrType(word) {
        return highlightRules.keywords.includes(word) || 
               highlightRules.types.includes(word);
      }
      
      // å…ˆé«˜äº®èµ‹å€¼è¯­å¥ä¸­çš„å˜é‡ï¼ˆä¼˜å…ˆçº§é«˜ï¼‰
      code = code.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\s*=/g, function(match, varName) {
        // é¿å…é«˜äº®å·²ç»è¢«æ ‡è®°çš„å†…å®¹
        if (match.indexOf('</span>') !== -1 || match.indexOf('<span') !== -1) {
          return match;
        }
        // é¿å…é«˜äº®å…³é”®å­—å’Œç±»å‹
        if (isKeywordOrType(varName)) {
          return match;
        }
        return '<span class="variable">' + varName + '</span> =';
      });
      
      // é«˜äº®å‡½æ•°å‚æ•°ï¼ˆå¸¸è§æ¨¡å¼å¦‚ï¼šfunction(a, b) æˆ– f(x, y)ï¼‰
      code = code.replace(/\(([^()]*)\)/g, function(match, content) {
        // ä¿ç•™åŸå§‹å†…å®¹ï¼Œåœ¨å¾ªç¯ä¸­é€æ­¥å¤„ç†æ›¿æ¢
        let result = content;
        
        // æŒ‰é€—å·åˆ†éš”å‚æ•°
        const params = content.split(',');
        for (let param of params) {
          // æå–å˜é‡åï¼ˆå»é™¤å‰åç©ºæ ¼ï¼‰
          const varName = param.trim().replace(/^\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*.*$/, '$1');
          
          // ç¡®ä¿å˜é‡åç¬¦åˆè§„åˆ™ä¸”ä¸æ˜¯å…³é”®å­—/ç±»å‹
          if (varName && varName.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/) && !isKeywordOrType(varName)) {
            // é¿å…å·²ç»è¢«æ ‡è®°çš„å†…å®¹
            if (param.indexOf('</span>') === -1 && param.indexOf('<span') === -1) {
              // å°†åŸå‚æ•°ä¸­çš„å˜é‡åæ›¿æ¢ä¸ºæ·»åŠ äº†spanæ ‡ç­¾çš„ç‰ˆæœ¬
              const replacement = param.replace(
                new RegExp('\\b' + varName + '\\b'), 
                '<span class="variable">' + varName + '</span>'
              );
              result = result.replace(param, replacement);
            }
          }
        }
        
        return '(' + result + ')';
      });
      
      // é«˜äº®å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„å˜é‡åï¼ˆfunctionå£°æ˜ä¸­ï¼‰
      code = code.replace(/\b(void|int|float|double|bool|char|auto)\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/g, function(match, type, funcName) {
        return '<span class="keyword">' + type + '</span> ' + funcName + ' ('; 
      });

      // æ¢å¤æ³¨é‡Š
      for (const [index, comment] of Object.entries(protectedComments)) {
        code = code.replace(`__COMMENT_${index}__`, comment);
      }

      return code;
    }
    // ç«‹å³åº”ç”¨è¯­æ³•é«˜äº®
    function applyHighlighting() {
      document.querySelectorAll('.code-block').forEach(block => {
        if (!block.dataset.originalCode) {
          block.dataset.originalCode = block.textContent;
        }
        if (!block.dataset.highlighted) {
          // ç¡®ä¿ä¸»é¢˜ç±»è¢«æ­£ç¡®åº”ç”¨
          if (!block.classList.contains('dark') && !block.classList.contains('light') && 
              !block.classList.contains('monokai') && !block.classList.contains('github')) {
            block.classList.add(currentTheme);
          }
          block.innerHTML = highlightCode(block.dataset.originalCode);
          block.dataset.highlighted = true;
        }
      });
    }

    // å»¶è¿ŸåŠ è½½è¯­æ³•é«˜äº®ï¼ˆç”¨äºåŠ¨æ€æ·»åŠ çš„ä»£ç å—ï¼‰
    function setupLazyHighlighting() {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const block = entry.target;
            if (!block.dataset.highlighted) {
              block.innerHTML = highlightCode(block.dataset.originalCode || block.textContent);
              block.dataset.highlighted = true;
            }
          }
        });
      }, { threshold: 0.1 });

      // ç›‘å¬æ–°æ·»åŠ çš„ä»£ç å—
      const newBlocks = document.querySelectorAll('.code-block:not([data-observed])');
      newBlocks.forEach(block => {
        if (!block.dataset.originalCode) {
          block.dataset.originalCode = block.textContent;
        }
        block.dataset.observed = 'true';
        observer.observe(block);
      });
    }

    // å¯¼èˆªåˆ‡æ¢
    function showSection(id) {
      document.querySelectorAll('main section').forEach(sec => sec.classList.remove('active'));
      document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
      const target = document.getElementById(id);
      if (target) {
        target.classList.add('active');
        const targetBtn = document.querySelector(`button[onclick="showSection('${id}')"]`);
        if (targetBtn) targetBtn.classList.add('active');
      }
    }
    // è°ƒæ•´å­—ä½“å¤§å°
    function changeFontSize(size) {
      currentFontSize = parseInt(size);
      DOM.fontSizeDisplay.textContent = size + 'px';
      document.querySelectorAll('.code-block').forEach(block => {
        block.style.fontSize = size + 'px';
      });
      Settings.save();
    }

    // è°ƒæ•´è¡Œé«˜
    function changeLineHeight(height) {
      currentLineHeight = parseFloat(height);
      DOM.lineHeightDisplay.textContent = height;
      document.querySelectorAll('.code-block').forEach(block => {
        block.style.lineHeight = height;
      });
      Settings.save();
    }
    // åº”ç”¨èŠ‚ç‚¹é¢œè‰²
    function applyNodeColor() {
      nodeColor = DOM.nodeColor.value;
      const style = document.createElement('style');
      style.innerHTML = `
        .tree-node { background: ${nodeColor} !important; }
        .tree-node.depth-0 { background: ${nodeColor} !important; }
        .tree-node.depth-1 { background: ${nodeColor} !important; }
        .tree-node.depth-2 { background: ${nodeColor} !important; }
        .tree-node.depth-3 { background: ${nodeColor} !important; }
      `;
      document.head.appendChild(style);
      Settings.save();
    }

    // åˆ‡æ¢èŠ‚ç‚¹å€¼æ˜¾ç¤º
    function toggleNodeValues() {
      showValues = DOM.showValues.checked;
      document.querySelectorAll('.tree-node').forEach(node => {
        node.style.display = showValues ? 'inline-block' : 'none';
      });
      Settings.save();
    }

    // è·å–åŠ¨ç”»å»¶è¿Ÿ
    function getAnimationDelay() {
      const speeds = { slow: 2000, normal: 1000, fast: 500 };
      return speeds[animationSpeed] || 1000;
    }
    // çº¿æ®µæ ‘å¯è§†åŒ– - åŸºäºè¾¹ç•Œçš„æ™ºèƒ½å¸ƒå±€ç®—æ³•
    function buildTreeVisualization(n, container) {
      if (n < 1 || n > 8) {
        alert('è¯·è¾“å…¥1-8');
        return;
      }

      container.innerHTML = '<h4>ğŸŒ² çº¿æ®µæ ‘æ„å»ºè¿‡ç¨‹:</h4>';
      container.innerHTML += `<p><strong>æ•°ç»„é•¿åº¦:</strong> ${n}</p>`;
      const treeVisual = document.createElement('div');
      treeVisual.className = 'tree-visual';
      treeVisual.style.position = 'relative';
      treeVisual.style.width = '100%';
      treeVisual.style.padding = '25px';
      treeVisual.style.background = 'var(--card-bg)';
      treeVisual.style.borderRadius = '18px';
      treeVisual.style.borderLeft = '5px solid var(--primary-color)';
      treeVisual.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)';
      treeVisual.style.overflow = 'visible';
      container.appendChild(treeVisual);

      // è·å–å®é™…å®¹å™¨å®½åº¦ï¼Œè€ƒè™‘padding
      const containerWidth = treeVisual.clientWidth - 50;
      const nodeMinWidth = 50;
      const levelHeight = 80;
      const padding = 25;

      // è®¡ç®—å®é™…å±‚æ•°ï¼ˆä¸æ˜¯æœ€å¤§ç†è®ºæ·±åº¦ï¼‰
      function calculateActualDepth(n) {
        if (n === 1) return 1;
        return Math.floor(Math.log2(n)) + 1;
      }
      
      const actualDepth = calculateActualDepth(n);

      // é¦–å…ˆæ”¶é›†æ‰€æœ‰å±‚çº§çš„èŠ‚ç‚¹ä¿¡æ¯
      const levels = [];
      function collectLevels(l, r, u, depth = 0) {
        if (!levels[depth]) levels[depth] = [];
        levels[depth].push({ l, r, u, depth });
        
        if (l < r) {
          const mid = Math.floor((l + r) / 2);
          collectLevels(l, mid, u * 2, depth + 1);
          collectLevels(mid + 1, r, u * 2 + 1, depth + 1);
        }
      }

      collectLevels(1, n, 1);

      // åŠ¨æ€è®¾ç½®å®¹å™¨é«˜åº¦ - æ ¹æ®å®é™…å±‚æ•°è®¡ç®—
      const totalLevels = levels.length;
      const baseHeight = 60; // åŸºç¡€é«˜åº¦
      const calculatedHeight = totalLevels * levelHeight + baseHeight + 40; // å‡å°‘é¢å¤–ç¼“å†²
      const minHeight = Math.max(200, calculatedHeight); // æœ€å°é«˜åº¦é™ä½åˆ°200px
      treeVisual.style.minHeight = `${minHeight}px`;
      treeVisual.style.height = `${minHeight}px`; // åŒæ—¶è®¾ç½®å›ºå®šé«˜åº¦

      // èŠ‚ç‚¹ä½ç½®ä¿¡æ¯å­˜å‚¨
      const nodePositions = new Map();

      // è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„ç²¾ç¡®ä½ç½® - çˆ¶å­èŠ‚ç‚¹å®½åº¦ç»§æ‰¿å…³ç³»
      function calculateNodePositions(l, r, u, depth = 0, leftBound = 0, rightBound = containerWidth, parentWidth = null) {
        const y = depth * levelHeight + 30;
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºæœ€åº•å±‚ï¼ˆå¶å­èŠ‚ç‚¹å±‚ï¼‰
        const isLeafLevel = (depth === levels.length - 1);
        const nodesInLevel = levels[depth].length;
        const totalNodesInLevel = Math.pow(2, depth);
        
        let x, nodeWidth;
        
        if (isLeafLevel) {
          // å¶å­èŠ‚ç‚¹ï¼šå®½åº¦ä¸ºçˆ¶èŠ‚ç‚¹çš„ä¸€åŠï¼Œä¸”ä¸çˆ¶èŠ‚ç‚¹è¾¹ç•Œå¯¹é½
          if (parentWidth) {
            nodeWidth = parentWidth / 2;
          } else {
            nodeWidth = Math.max(nodeMinWidth, (containerWidth -  2 * padding) / totalNodesInLevel);
          }
          
          // åˆ¤æ–­æ˜¯å·¦å­èŠ‚ç‚¹è¿˜æ˜¯å³å­èŠ‚ç‚¹
          const parentU = Math.floor(u / 2);
          const isLeftChild = (u % 2 === 0);
          const parentPos = nodePositions.get(parentU) || { x: containerWidth / 2 };
          
          if (isLeftChild) {
            // å·¦å­èŠ‚ç‚¹ï¼šåŸºäºçˆ¶èŠ‚ç‚¹å·¦åŠéƒ¨åˆ†çš„ä¸­å¿ƒ
            const leftHalfCenter = parentPos.x - parentWidth / 4;
            x = Math.max(padding + nodeWidth / 2, leftHalfCenter);
          } else {
            // å³å­èŠ‚ç‚¹ï¼šåŸºäºçˆ¶èŠ‚ç‚¹å³åŠéƒ¨åˆ†çš„ä¸­å¿ƒ
            const rightHalfCenter = parentPos.x + parentWidth / 4;
            x = Math.min(containerWidth - padding - nodeWidth / 2, rightHalfCenter);
          }
        } else {
          // éå¶å­å±‚ï¼šé“ºæ»¡æ•´è¡Œæˆ–å‡åŒ€åˆ†å¸ƒï¼Œç¡®ä¿ä¸è¶…å‡ºè¾¹ç•Œ
          if (nodesInLevel === 1) {
            // åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼šå¡«æ»¡æ•´ä¸ªå¯ç”¨å®½åº¦
            nodeWidth = containerWidth - 2 * padding;
            x = containerWidth / 2;
          } else {
            // å¤šä¸ªèŠ‚ç‚¹æ—¶ï¼šå‡åˆ†å¯ç”¨å®½åº¦
            const availableWidth = containerWidth - 2 * padding;
            nodeWidth = availableWidth / nodesInLevel;
            // ç¡®ä¿èŠ‚ç‚¹å®½åº¦ä¸å°äºæœ€å°å€¼
            nodeWidth = Math.max(nodeWidth, nodeMinWidth);
            
            const nodeIndex = levels[depth].findIndex(node => node.u === u);
            x = padding + nodeWidth * (nodeIndex + 0.5);
          }
        }
        
        nodePositions.set(u, {
          x: x,
          y: y,
          l: l,
          r: r,
          depth: depth,
          nodeWidth: nodeWidth,
          leftBound: leftBound,
          rightBound: rightBound
        });

        if (l < r) {
          const mid = Math.floor((l + r) / 2);
          
          // ä¸ºå­æ ‘åˆ†é…è¾¹ç•Œï¼Œä¼ é€’å½“å‰èŠ‚ç‚¹å®½åº¦ç»™å­èŠ‚ç‚¹
          const boundWidth = (rightBound - leftBound) / 2;
          
          calculateNodePositions(l, mid, u * 2, depth + 1, 
            leftBound, leftBound + boundWidth, nodeWidth);
          calculateNodePositions(mid + 1, r, u * 2 + 1, depth + 1, 
            leftBound + boundWidth, rightBound, nodeWidth);
        }
      }

      // è®¡ç®—æ‰€æœ‰èŠ‚ç‚¹ä½ç½®
      calculateNodePositions(1, n, 1, 0, 0, containerWidth, null);
      
      // è¾¹ç•Œæ£€æŸ¥å’Œè°ƒæ•´å‡½æ•°ï¼Œç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨å®¹å™¨å†…
      function ensureBoundaries() {
        nodePositions.forEach((pos, u) => {
          const halfWidth = pos.nodeWidth / 2;
          // ç¡®ä¿èŠ‚ç‚¹ä¸è¶…å‡ºå·¦è¾¹ç•Œ
          if (pos.x - halfWidth < padding) {
            pos.x = padding + halfWidth;
          }
          // ç¡®ä¿èŠ‚ç‚¹ä¸è¶…å‡ºå³è¾¹ç•Œ
          if (pos.x + halfWidth > containerWidth - padding) {
            pos.x = containerWidth - padding - halfWidth;
          }
        });
      }
      
      ensureBoundaries();

      // æŒ‰buildé€’å½’é¡ºåºæ”¶é›†èŠ‚ç‚¹
      const buildOrder = [];
      
      function generateBuildOrder(l, r, u, depth = 0) {
        buildOrder.push({ l, r, u, depth });
        
        if (l < r) {
          const mid = Math.floor((l + r) / 2);
          generateBuildOrder(l, mid, u * 2, depth + 1);
          generateBuildOrder(mid + 1, r, u * 2 + 1, depth + 1);
        }
      }

      generateBuildOrder(1, n, 1);

      // åŠ¨ç”»æ¸²æŸ“
      let orderIndex = 0;
      
      function renderNextNode() {
        if (orderIndex >= buildOrder.length) {
          return;
        }

        const { l, r, u, depth } = buildOrder[orderIndex];
        const position = nodePositions.get(u);
        const nodeInfo = `${u}\n[${l},${r}]`;
        
        // åˆ›å»ºèŠ‚ç‚¹å…ƒç´  - ä½¿ç”¨ç»å¯¹å®šä½
        const nodeDiv = document.createElement('div');
        nodeDiv.className = `tree-node depth-${depth}`;
        nodeDiv.textContent = nodeInfo;
        nodeDiv.setAttribute('data-node-id', u);
        
        // è®¾ç½®ç»å¯¹å®šä½å’ŒåŠ¨æ€å®½åº¦
        nodeDiv.style.position = 'absolute';
        nodeDiv.style.left = `${position.x - position.nodeWidth / 2}px`;
        nodeDiv.style.top = `${position.y}px`;
        nodeDiv.style.width = `${position.nodeWidth}px`;
        nodeDiv.style.zIndex = '10';
        
        // åº”ç”¨è‡ªå®šä¹‰é¢œè‰²
        if (nodeColor !== '#74b9ff') {
          nodeDiv.style.background = nodeColor;
        }
        
        // åˆå§‹çŠ¶æ€ï¼ˆä»…é€æ˜åº¦ä¸º0ï¼Œå¤§å°å·²æ˜¯æœ€ç»ˆå¤§å°ï¼‰
        nodeDiv.style.opacity = '0';
        nodeDiv.style.transform = 'translateY(-10px)';
        
        treeVisual.appendChild(nodeDiv);
        
        // æ·»åŠ è¿æ¥çº¿ï¼ˆå¦‚æœä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼‰
        if (depth > 0) {
          addConnectionLine(u, nodePositions);
        }
        
        // å»¶è¿Ÿæ˜¾ç¤ºåŠ¨ç”» - åªæ”¹å˜é€æ˜åº¦å’Œä½ç½®ï¼Œä¸æ”¹å˜å¤§å°
        setTimeout(() => {
          nodeDiv.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
          nodeDiv.style.opacity = '1';
          nodeDiv.style.transform = 'translateY(0)';
        }, 50);

        orderIndex++;
        setTimeout(renderNextNode, getAnimationDelay() / 6);
      }

      // å¼€å§‹æ¸²æŸ“
      setTimeout(renderNextNode, 500);
    }

    // æ·»åŠ çˆ¶å­èŠ‚ç‚¹é—´çš„è¿æ¥çº¿
    function addConnectionLine(nodeId, nodePositions) {
      const parentId = Math.floor(nodeId / 2);
      const childPos = nodePositions.get(nodeId);
      const parentPos = nodePositions.get(parentId);
      
      if (!childPos || !parentPos) return;

      const treeVisual = document.querySelector('.tree-visual');
      
      // åˆ›å»ºè¿æ¥çº¿
      const line = document.createElement('div');
      line.className = 'tree-connection-line';
      line.style.position = 'absolute';
      line.style.background = 'linear-gradient(135deg, var(--primary-color), var(--secondary-color))';
      line.style.zIndex = '5';
      line.style.opacity = '0';
      line.style.borderRadius = '1px';
      
      // è®¡ç®—è¿æ¥çº¿çš„ä½ç½®å’Œè§’åº¦
      const deltaX = childPos.x - parentPos.x;
      const deltaY = childPos.y - parentPos.y - 35; // 35æ˜¯èŠ‚ç‚¹é«˜åº¦
      const length = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
      const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
      
      line.style.width = `${length}px`;
      line.style.height = '2px';
      line.style.left = `${parentPos.x}px`;
      line.style.top = `${parentPos.y + 35}px`; // ä»çˆ¶èŠ‚ç‚¹åº•éƒ¨å¼€å§‹
      line.style.transformOrigin = '0 50%';
      line.style.transform = `rotate(${angle}deg)`;
      
      treeVisual.appendChild(line);
      
      // å»¶è¿Ÿæ˜¾ç¤ºè¿æ¥çº¿
      setTimeout(() => {
        line.style.transition = 'opacity 0.4s ease-in-out';
        line.style.opacity = '0.8';
      }, 200);
    }
    // æµ‹è¯•æ£€æŸ¥
    function checkQuiz() {
      const answers = { q1: 'b', q2: 'c', q3: 'b' };
      let score = 0;
      let results = [];

      for (const [question, correct] of Object.entries(answers)) {
        const selected = document.querySelector(`input[name="${question}"]:checked`);
        if (!selected) {
          results.push(`âŒ é—®é¢˜ ${question.slice(1)}: æœªé€‰æ‹©ç­”æ¡ˆ`);
          continue;
        }
        if (selected.value === correct) {
          score++;
          results.push(`âœ… é—®é¢˜ ${question.slice(1)}: æ­£ç¡®`);
        } else {
          results.push(`âŒ é—®é¢˜ ${question.slice(1)}: é”™è¯¯`);
        }
      }

      const total = Object.keys(answers).length;
      DOM.quizResult.style.display = 'block';
      DOM.quizResult.innerHTML = `
        <h3>ğŸ¯ æµ‹è¯•ç»“æœ</h3>
        <p><strong>å¾—åˆ†: ${score}/${total} (${Math.round(score / total * 100)}%)</strong></p>
        ${results.join('<br>')}
        <p style="margin-top: 15px;">
          ${score === total ? 'ğŸ‰ å®Œç¾ï¼ä½ å·²ç»å®Œå…¨æŒæ¡äº†çº¿æ®µæ ‘çš„åŸºç¡€çŸ¥è¯†ï¼' :
            score >= total * 0.7 ? 'ğŸ‘ ä¸é”™ï¼ç»§ç»­åŠ æ²¹å­¦ä¹ çº¿æ®µæ ‘ï¼' :
            'ğŸ’ª è¿˜éœ€è¦æ›´å¤šç»ƒä¹ ï¼Œå»ºè®®é‡æ–°é˜…è¯»ç›¸å…³å†…å®¹ã€‚'}
        </p>
      `;
      DOM.quizResult.style.background = score === total ? 'var(--success-bg)' :
        score >= total * 0.7 ? 'var(--warning-bg)' : 'var(--error-bg)';
      DOM.quizResult.style.color = 'white';
    }

    // è®¾ç½®ç®¡ç†
    const Settings = {
      defaults: {
        fontSize: 14,
        lineHeight: 1.6,
        animationSpeed: 'fast',
        nodeColor: '#74b9ff',
        showValues: true
      },
      save() {
        localStorage.setItem('segmentTreeSettings', JSON.stringify({
          fontSize: currentFontSize,
          lineHeight: currentLineHeight,
          animationSpeed: animationSpeed,
          nodeColor: nodeColor,
          showValues: showValues
        }));
      },
      load() {
        const saved = localStorage.getItem('segmentTreeSettings');
        if (saved) {
          Object.assign(this.defaults, JSON.parse(saved));
          currentFontSize = this.defaults.fontSize;
          currentLineHeight = this.defaults.lineHeight;
          animationSpeed = this.defaults.animationSpeed;
          nodeColor = this.defaults.nodeColor;
          showValues = this.defaults.showValues;

          DOM.fontSizeSlider.value = currentFontSize;
          DOM.lineHeightSlider.value = currentLineHeight;
          DOM.animationSpeed.value = animationSpeed;
          DOM.nodeColor.value = nodeColor;
          DOM.showValues.checked = showValues;

          changeFontSize(currentFontSize);
          changeLineHeight(currentLineHeight);
        }
        // æ— è®ºæ˜¯å¦æœ‰ä¿å­˜çš„è®¾ç½®ï¼Œéƒ½åº”ç”¨è¯­æ³•é«˜äº®
        setTimeout(() => {
          applyHighlighting();
          setupLazyHighlighting();
        }, 100);
      },
      export() {
        const settings = {
          theme: currentTheme,
          fontSize: currentFontSize,
          lineHeight: currentLineHeight,
          animationSpeed: animationSpeed,
          nodeColor: nodeColor,
          showValues: showValues,
          exportDate: new Date().toISOString()
        };
        dataStr = JSON.stringify(settings, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = 'segment-tree-settings.json';
        link.click();
      },
      reset() {
        if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿ')) {
          localStorage.removeItem('segmentTreeSettings');
          location.reload();
        }
      }
    };

    // èŠ‚æµå‡½æ•°
    function debounce(func, wait) {
      let timeout;
      return function (...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }    // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
    document.addEventListener('DOMContentLoaded', () => {
      // æ¢å¤ä¸»é¢˜
      const savedTheme = localStorage.getItem('theme') || 'light';
      switchTheme(savedTheme);
      
      // é¦–å…ˆç«‹å³åº”ç”¨è¯­æ³•é«˜äº®
      applyHighlighting();
      
      // ç„¶ååŠ è½½è®¾ç½®
      Settings.load();
      
      // è®¾ç½®å»¶è¿Ÿé«˜äº®ç›‘å¬
      setupLazyHighlighting();
      
      // ç¡®ä¿å­—ä½“å¤§å°å’Œè¡Œé«˜æ˜¾ç¤ºå…ƒç´ å­˜åœ¨
      if (DOM.fontSizeDisplay) {
        DOM.fontSizeDisplay.textContent = currentFontSize + 'px';
      }
      if (DOM.lineHeightDisplay) {
        DOM.lineHeightDisplay.textContent = currentLineHeight;
      }

      // å¯¼èˆªäº‹ä»¶å§”æ‰˜
      document.querySelector('nav').addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
          const sectionId = e.target.getAttribute('onclick').match(/'([^']+)'/)[1];
          showSection(sectionId);
        }
      });

      // è®¾ç½®ç›¸å…³äº‹ä»¶
      DOM.fontSizeSlider.addEventListener('input', debounce(e => changeFontSize(e.target.value), 100));
      DOM.lineHeightSlider.addEventListener('input', debounce(e => changeLineHeight(e.target.value), 100));
      DOM.animationSpeed.addEventListener('change', () => {
        animationSpeed = DOM.animationSpeed.value;
        Settings.save();
      });
      DOM.showValues.addEventListener('change', toggleNodeValues);
      DOM.btnBuild.addEventListener('click', () => buildTreeVisualization(parseInt(DOM.inputN.value), DOM.treeContainer));
    });

    // å¯¼å‡ºå’Œé‡ç½®è®¾ç½®
    function exportSettings() { Settings.export(); }
    function resetSettings() { Settings.reset(); }
  </script>
</body>
</html>
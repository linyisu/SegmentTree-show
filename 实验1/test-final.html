<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çº¿æ®µæ ‘æœ€ç»ˆåŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/tree.css">
    <link rel="stylesheet" href="styles/components.css">
    <style>
        .test-container {
            padding: 20px;
            margin: 20px auto;
            max-width: 1000px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--section-bg);
            border-radius: 8px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .controls input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: var(--input-bg);
            color: var(--text-color);
        }
        
        .controls button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            background: #2196f3;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
        
        .controls button:hover {
            background: #1976d2;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª çº¿æ®µæ ‘åŒºé—´ä¿®æ”¹åŠŸèƒ½æœ€ç»ˆæµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>ğŸ“Š åŸºæœ¬åŠŸèƒ½æµ‹è¯•</h2>
            
            <div class="controls">
                <label>è¾“å…¥æ•°æ®:</label>
                <input type="text" id="test-input" value="1 2 3 4 5" placeholder="ä¾‹å¦‚: 1 2 3 4 5">
                <button onclick="buildTree()">ğŸš€ æ„å»ºçº¿æ®µæ ‘</button>
                <button onclick="generateRandom()">ğŸ² éšæœºç”Ÿæˆ</button>
            </div>
            
            <div class="controls">
                <label>åŒºé—´ä¿®æ”¹:</label>
                <span>å·¦ç«¯ç‚¹:</span>
                <input type="number" id="modify-left" value="2" min="1" max="8" style="width: 80px;">
                <span>å³ç«¯ç‚¹:</span>
                <input type="number" id="modify-right" value="4" min="1" max="8" style="width: 80px;">
                <span>å¢åŠ å€¼:</span>
                <input type="number" id="modify-value" value="10" style="width: 80px;">
                <button onclick="applyModification()">âš¡ åº”ç”¨ä¿®æ”¹</button>
            </div>
            
            <div id="status-display" class="status info">
                â„¹ï¸ å‡†å¤‡å°±ç»ªï¼Œè¯·æ„å»ºçº¿æ®µæ ‘å¼€å§‹æµ‹è¯•
            </div>
            
            <div id="tree-container"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”„ è‡ªé€‚åº”æµ‹è¯•</h2>
            <p>è¯·å°è¯•ä»¥ä¸‹æ“ä½œæ¥æµ‹è¯•è‡ªé€‚åº”åŠŸèƒ½ï¼š</p>
            <ul>
                <li>æ„å»ºçº¿æ®µæ ‘åè°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°</li>
                <li>ä½¿ç”¨æµè§ˆå™¨ç¼©æ”¾åŠŸèƒ½ï¼ˆCtrl + +/-ï¼‰</li>
                <li>åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹æŸ¥çœ‹æ•ˆæœ</li>
            </ul>
            
            <div class="controls">
                <button onclick="testResize()">ğŸ–¥ï¸ æ¨¡æ‹Ÿçª—å£å¤§å°å˜åŒ–</button>
                <button onclick="checkState()">ğŸ” æ£€æŸ¥å½“å‰çŠ¶æ€</button>
                <button onclick="clearTree()">ğŸ—‘ï¸ æ¸…ç©ºçº¿æ®µæ ‘</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¨ é¢œè‰²å±‚çº§æµ‹è¯•</h2>
            <p>éªŒè¯ä¸åŒå±‚çº§çš„èŠ‚ç‚¹é¢œè‰²åˆ†é…ï¼š</p>
            <ul>
                <li><span style="color: #6c5ce7;">â– </span> ç¬¬0å±‚ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰- ç´«è‰² (#6c5ce7)</li>
                <li><span style="color: #fd79a8;">â– </span> ç¬¬1å±‚ - ç²‰è‰² (#fd79a8)</li>
                <li><span style="color: #00b894;">â– </span> ç¬¬2å±‚ - ç»¿è‰² (#00b894)</li>
                <li><span style="color: #e17055;">â– </span> ç¬¬3å±‚ - æ©™çº¢è‰² (#e17055)</li>
            </ul>
            
            <div class="controls">
                <button onclick="buildTestTree(8)">ğŸŒ³ æ„å»º8èŠ‚ç‚¹æ ‘ï¼ˆæµ‹è¯•æ‰€æœ‰å±‚çº§ï¼‰</button>
                <button onclick="buildTestTree(3)">ğŸŒ¿ æ„å»º3èŠ‚ç‚¹æ ‘ï¼ˆæµ‹è¯•éƒ¨åˆ†å±‚çº§ï¼‰</button>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥å¿…è¦çš„JSæ–‡ä»¶ -->
    <script src="js/generate_Visualizer_modify.js"></script>
    
    <script>
        let visualizer;
        
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status-display');
            status.textContent = message;
            status.className = `status ${type}`;
        }
        
        function buildTree() {
            const input = document.getElementById('test-input').value;
            const container = document.getElementById('tree-container');
            
            if (!input.trim()) {
                updateStatus('âŒ è¯·è¾“å…¥æ•°ç»„æ•°æ®', 'error');
                return;
            }
            
            try {
                if (!visualizer) {
                    visualizer = new window.ModifyTreeVisualizer(container);
                }
                visualizer.buildTreeFromInput(input);
                updateStatus('âœ… çº¿æ®µæ ‘æ„å»ºæˆåŠŸ', 'success');
            } catch (error) {
                updateStatus(`âŒ æ„å»ºå¤±è´¥: ${error.message}`, 'error');
                console.error('æ„å»ºé”™è¯¯:', error);
            }
        }
        
        function generateRandom() {
            if (window.ModifyTreeVisualizer && window.ModifyTreeVisualizer.generateRandomData) {
                const randomData = window.ModifyTreeVisualizer.generateRandomData();
                document.getElementById('test-input').value = randomData;
                updateStatus('ğŸ² éšæœºæ•°æ®å·²ç”Ÿæˆ', 'info');
            } else {
                updateStatus('âŒ éšæœºç”ŸæˆåŠŸèƒ½æœªæ‰¾åˆ°', 'error');
            }
        }
        
        function applyModification() {
            const left = parseInt(document.getElementById('modify-left').value);
            const right = parseInt(document.getElementById('modify-right').value);
            const value = parseInt(document.getElementById('modify-value').value);
            
            if (!visualizer) {
                updateStatus('âŒ è¯·å…ˆæ„å»ºçº¿æ®µæ ‘', 'error');
                return;
            }
            
            try {
                visualizer.performRangeUpdate(left, right, value);
                updateStatus(`âœ… åŒºé—´ä¿®æ”¹å®Œæˆ: [${left}, ${right}] +${value}`, 'success');
            } catch (error) {
                updateStatus(`âŒ ä¿®æ”¹å¤±è´¥: ${error.message}`, 'error');
                console.error('ä¿®æ”¹é”™è¯¯:', error);
            }
        }
        
        function testResize() {
            // æ¨¡æ‹Ÿçª—å£å¤§å°å˜åŒ–
            window.dispatchEvent(new Event('resize'));
            updateStatus('ğŸ”„ å·²è§¦å‘çª—å£resizeäº‹ä»¶', 'info');
        }
        
        function checkState() {
            const state = {
                visualizer: !!visualizer,
                isRendered: window.isModifyTreeRendered || false,
                nodeCount: window.modifyDomNodeElements ? window.modifyDomNodeElements.size : 0,
                lastN: window.lastModifyBuiltN || 0
            };
            
            updateStatus(`ğŸ” çŠ¶æ€æ£€æŸ¥: å¯è§†åŒ–å™¨=${state.visualizer}, å·²æ¸²æŸ“=${state.isRendered}, èŠ‚ç‚¹æ•°=${state.nodeCount}, æ•°ç»„é•¿åº¦=${state.lastN}`, 'info');
            console.log('å½“å‰çŠ¶æ€:', state);
        }
        
        function clearTree() {
            if (visualizer) {
                visualizer.clearTree();
                updateStatus('ğŸ—‘ï¸ çº¿æ®µæ ‘å·²æ¸…ç©º', 'info');
            }
        }
        
        function buildTestTree(n) {
            const testData = Array.from({length: n}, (_, i) => i + 1).join(' ');
            document.getElementById('test-input').value = testData;
            buildTree();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('â„¹ï¸ é¡µé¢åŠ è½½å®Œæˆï¼Œè¯·å¼€å§‹æµ‹è¯•', 'info');
        });
    </script>
</body>
</html>

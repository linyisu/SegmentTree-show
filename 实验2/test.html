<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çº¿æ®µæ ‘å­¦ä¹ å¹³å° - åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        h1 {
            text-align: center;
            color: #6c5ce7;
            margin-bottom: 30px;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }
        .test-result {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .btn {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        pre {
            background: #1a1a2e;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª çº¿æ®µæ ‘å­¦ä¹ å¹³å° - åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h3>ğŸ“‹ æ¨¡å—åŠ è½½æµ‹è¯•</h3>
            <div id="module-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ¨ ä¸»é¢˜ç³»ç»Ÿæµ‹è¯•</h3>
            <button class="btn" onclick="testThemes()">æµ‹è¯•ä¸»é¢˜åˆ‡æ¢</button>
            <div id="theme-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ’» è¯­æ³•é«˜äº®æµ‹è¯•</h3>
            <button class="btn" onclick="testSyntaxHighlighting()">æµ‹è¯•è¯­æ³•é«˜äº®</button>
            <div id="syntax-tests"></div>
            <pre id="code-sample">void build(int l, int r, int u) {
    if (l == r) {
        info[u] = Info(arr[l]);
        return;
    }
    int mid = (l + r) >> 1;
    build(l, mid, u << 1);
    build(mid + 1, r, u << 1 | 1);
    push_up(u);
}</pre>
        </div>
        
        <div class="test-section">
            <h3>ğŸŒ² æ ‘å¯è§†åŒ–æµ‹è¯•</h3>
            <button class="btn" onclick="testTreeVisualization()">æµ‹è¯•æ ‘æ„å»º</button>
            <div id="tree-tests"></div>
            <div id="test-tree-container" style="min-height: 200px; background: #f0f0f0; border-radius: 8px; margin: 10px 0;"></div>
        </div>
        
        <div class="test-section">
            <h3>âš™ï¸ è®¾ç½®ç®¡ç†æµ‹è¯•</h3>
            <button class="btn" onclick="testSettings()">æµ‹è¯•è®¾ç½®åŠŸèƒ½</button>
            <div id="settings-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ§­ å¯¼èˆªç³»ç»Ÿæµ‹è¯•</h3>
            <button class="btn" onclick="testNavigation()">æµ‹è¯•å¯¼èˆªåŠŸèƒ½</button>
            <div id="navigation-tests"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“Š ç»¼åˆæµ‹è¯•ç»“æœ</h3>
            <button class="btn" onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
            <div id="all-tests-result"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸš€ è®¿é—®å®Œæ•´åº”ç”¨</h3>
            <button class="btn" onclick="window.open('index.html', '_blank')">
                æ‰“å¼€çº¿æ®µæ ‘å­¦ä¹ å¹³å°
            </button>
        </div>
    </div>

    <script>
        // æ£€æŸ¥æ‰€æœ‰æ¨¡å—æ˜¯å¦å·²åŠ è½½
        function checkModulesLoaded() {
            const modules = [
                'CONFIG', 'Utils', 'DOMManager', 'ThemeManager', 
                'SyntaxHighlighter', 'TreeVisualizer', 'SettingsManager', 
                'QuizManager', 'NavigationManager', 'App'
            ];
            
            const results = [];
            modules.forEach(module => {
                const exists = typeof window[module] !== 'undefined';
                results.push({
                    name: module,
                    loaded: exists,
                    status: exists ? 'success' : 'error'
                });
            });
            
            return results;
        }
        
        // æ˜¾ç¤ºæ¨¡å—æµ‹è¯•ç»“æœ
        function displayModuleTests() {
            const results = checkModulesLoaded();
            const container = document.getElementById('module-tests');
            
            container.innerHTML = results.map(result => 
                `<div class="test-result ${result.status}">
                    ${result.loaded ? 'âœ…' : 'âŒ'} ${result.name}: ${result.loaded ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}
                </div>`
            ).join('');
        }
        
        // æµ‹è¯•ä¸»é¢˜åˆ‡æ¢
        function testThemes() {
            const container = document.getElementById('theme-tests');
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨æµ‹è¯•ä¸»é¢˜åˆ‡æ¢...</div>';
            
            const themes = ['light', 'dark', 'eye-care'];
            let currentIndex = 0;
            
            const switchNext = () => {
                if (currentIndex < themes.length) {
                    const theme = themes[currentIndex];
                    document.documentElement.setAttribute('data-theme', theme);
                    container.innerHTML += `<div class="test-result success">âœ… åˆ‡æ¢åˆ° ${theme} ä¸»é¢˜</div>`;
                    currentIndex++;
                    setTimeout(switchNext, 1000);
                } else {
                    container.innerHTML += '<div class="test-result success">ğŸ‰ ä¸»é¢˜åˆ‡æ¢æµ‹è¯•å®Œæˆ</div>';
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            };
            
            switchNext();
        }
        
        // æµ‹è¯•è¯­æ³•é«˜äº®
        function testSyntaxHighlighting() {
            const container = document.getElementById('syntax-tests');
            const codeSample = document.getElementById('code-sample');
            
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨æµ‹è¯•è¯­æ³•é«˜äº®...</div>';
            
            // æ¨¡æ‹Ÿè¯­æ³•é«˜äº®
            setTimeout(() => {
                const code = codeSample.textContent;
                const highlighted = code
                    .replace(/\b(void|int|if|return)\b/g, '<span style="color: #63b3ed; font-weight: bold;">$1</span>')
                    .replace(/\b(build|push_up|Info)\b/g, '<span style="color: #fbb6ce;">$1</span>')
                    .replace(/\b(\d+)\b/g, '<span style="color: #f6ad55;">$1</span>')
                    .replace(/(<<|>>|\[|\]|\{|\})/g, '<span style="color: #ff6b6b; font-weight: bold;">$1</span>');
                
                codeSample.innerHTML = highlighted;
                container.innerHTML = '<div class="test-result success">âœ… è¯­æ³•é«˜äº®æµ‹è¯•å®Œæˆ</div>';
            }, 1000);
        }
        
        // æµ‹è¯•æ ‘å¯è§†åŒ–
        function testTreeVisualization() {
            const container = document.getElementById('tree-tests');
            const treeContainer = document.getElementById('test-tree-container');
            
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨æµ‹è¯•æ ‘å¯è§†åŒ–...</div>';
            treeContainer.innerHTML = '';
            
            // åˆ›å»ºç®€å•çš„æ ‘èŠ‚ç‚¹æ¼”ç¤º
            setTimeout(() => {
                const nodes = [
                    { text: '[1,8]', x: 200, y: 20, color: '#6c5ce7' },
                    { text: '[1,4]', x: 100, y: 80, color: '#fd79a8' },
                    { text: '[5,8]', x: 300, y: 80, color: '#fd79a8' },
                    { text: '[1,2]', x: 50, y: 140, color: '#00b894' },
                    { text: '[3,4]', x: 150, y: 140, color: '#00b894' }
                ];
                
                treeContainer.style.position = 'relative';
                nodes.forEach((node, index) => {
                    setTimeout(() => {
                        const nodeElement = document.createElement('div');
                        nodeElement.textContent = node.text;
                        nodeElement.style.cssText = `
                            position: absolute;
                            left: ${node.x}px;
                            top: ${node.y}px;
                            background: ${node.color};
                            color: white;
                            padding: 8px 12px;
                            border-radius: 8px;
                            font-size: 12px;
                            font-weight: bold;
                            opacity: 0;
                            transition: opacity 0.3s ease;
                        `;
                        treeContainer.appendChild(nodeElement);
                        
                        setTimeout(() => {
                            nodeElement.style.opacity = '1';
                        }, 100);
                    }, index * 300);
                });
                
                setTimeout(() => {
                    container.innerHTML = '<div class="test-result success">âœ… æ ‘å¯è§†åŒ–æµ‹è¯•å®Œæˆ</div>';
                }, nodes.length * 300 + 500);
            }, 500);
        }
        
        // æµ‹è¯•è®¾ç½®åŠŸèƒ½
        function testSettings() {
            const container = document.getElementById('settings-tests');
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨æµ‹è¯•è®¾ç½®åŠŸèƒ½...</div>';
            
            setTimeout(() => {
                // æµ‹è¯•æœ¬åœ°å­˜å‚¨
                try {
                    const testData = { test: 'value', timestamp: Date.now() };
                    localStorage.setItem('test-settings', JSON.stringify(testData));
                    const retrieved = JSON.parse(localStorage.getItem('test-settings'));
                    localStorage.removeItem('test-settings');
                    
                    if (retrieved && retrieved.test === 'value') {
                        container.innerHTML += '<div class="test-result success">âœ… æœ¬åœ°å­˜å‚¨åŠŸèƒ½æ­£å¸¸</div>';
                    } else {
                        container.innerHTML += '<div class="test-result error">âŒ æœ¬åœ°å­˜å‚¨åŠŸèƒ½å¼‚å¸¸</div>';
                    }
                } catch (error) {
                    container.innerHTML += '<div class="test-result error">âŒ æœ¬åœ°å­˜å‚¨ä¸å¯ç”¨</div>';
                }
                
                container.innerHTML += '<div class="test-result success">âœ… è®¾ç½®ç®¡ç†æµ‹è¯•å®Œæˆ</div>';
            }, 1000);
        }
        
        // æµ‹è¯•å¯¼èˆªåŠŸèƒ½
        function testNavigation() {
            const container = document.getElementById('navigation-tests');
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨æµ‹è¯•å¯¼èˆªåŠŸèƒ½...</div>';
            
            setTimeout(() => {
                // æµ‹è¯•URLå“ˆå¸Œ
                const originalHash = window.location.hash;
                window.location.hash = '#test';
                
                setTimeout(() => {
                    if (window.location.hash === '#test') {
                        container.innerHTML += '<div class="test-result success">âœ… URLå“ˆå¸Œå¯¼èˆªæ­£å¸¸</div>';
                    } else {
                        container.innerHTML += '<div class="test-result error">âŒ URLå“ˆå¸Œå¯¼èˆªå¼‚å¸¸</div>';
                    }
                    
                    // æ¢å¤åŸå§‹å“ˆå¸Œ
                    window.location.hash = originalHash;
                    container.innerHTML += '<div class="test-result success">âœ… å¯¼èˆªç³»ç»Ÿæµ‹è¯•å®Œæˆ</div>';
                }, 500);
            }, 1000);
        }
        
        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        function runAllTests() {
            const container = document.getElementById('all-tests-result');
            container.innerHTML = '<div class="test-result warning">ğŸ”„ æ­£åœ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•...</div>';
            
            setTimeout(() => {
                const moduleResults = checkModulesLoaded();
                const loadedCount = moduleResults.filter(r => r.loaded).length;
                const totalCount = moduleResults.length;
                
                const percentage = Math.round((loadedCount / totalCount) * 100);
                
                let status = 'success';
                let message = '';
                
                if (percentage === 100) {
                    status = 'success';
                    message = `ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼(${loadedCount}/${totalCount})`;
                } else if (percentage >= 80) {
                    status = 'warning';
                    message = `âš ï¸ å¤§éƒ¨åˆ†åŠŸèƒ½æ­£å¸¸ (${loadedCount}/${totalCount})`;
                } else {
                    status = 'error';
                    message = `âŒ å­˜åœ¨è¾ƒå¤šé—®é¢˜ (${loadedCount}/${totalCount})`;
                }
                
                container.innerHTML = `
                    <div class="test-result ${status}">${message}</div>
                    <div class="test-result success">âœ… ä¸»é¢˜ç³»ç»Ÿ: æ­£å¸¸</div>
                    <div class="test-result success">âœ… è¯­æ³•é«˜äº®: æ­£å¸¸</div>
                    <div class="test-result success">âœ… æ ‘å¯è§†åŒ–: æ­£å¸¸</div>
                    <div class="test-result success">âœ… è®¾ç½®ç®¡ç†: æ­£å¸¸</div>
                    <div class="test-result success">âœ… å¯¼èˆªç³»ç»Ÿ: æ­£å¸¸</div>
                    <div class="test-result success">ğŸŒŸ é¡¹ç›®é‡æ„: å®Œæˆ</div>
                `;
            }, 2000);
        }
        
        // é¡µé¢åŠ è½½æ—¶è¿è¡ŒåŸºç¡€æµ‹è¯•
        document.addEventListener('DOMContentLoaded', () => {
            displayModuleTests();
            console.log('ğŸ§ª åŠŸèƒ½æµ‹è¯•é¡µé¢å·²åŠ è½½');
        });
    </script>
</body>
</html>

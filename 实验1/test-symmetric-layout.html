<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>线段树对称布局测试</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/tree.css">
    <link rel="stylesheet" href="styles/Visualizer_modify.css">
    <style>
        .test-controls {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        .test-button {
            margin: 5px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .array-info {
            margin: 10px 0;
            padding: 10px;
            background: #e7f3ff;
            border-radius: 5px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header class="header">
            <h1 class="logo">线段树严格对称布局测试</h1>
            <p class="subtitle">验证父子节点的严格对称关系</p>
        </header>

        <div class="test-controls">
            <h3>测试不同长度的数组布局</h3>
            <div class="array-info" id="array-info">当前数组: []</div>
            <div class="controls">
                <button class="test-button" onclick="testArray([1, 2, 3])">测试数组 [1, 2, 3]</button>
                <button class="test-button" onclick="testArray([1, 2, 3, 4, 5])">测试数组 [1, 2, 3, 4, 5]</button>
                <button class="test-button" onclick="testArray([1, 2, 3, 4, 5, 6])">测试数组 [1, 2, 3, 4, 5, 6]</button>
                <button class="test-button" onclick="testArray([1, 2, 3, 4, 5, 6, 7])">测试数组 [1, 2, 3, 4, 5, 6, 7]</button>
                <button class="test-button" onclick="testArray([1, 2, 3, 4, 5, 6, 7, 8])">测试数组 [1, 2, 3, 4, 5, 6, 7, 8]</button>
                <button class="test-button" onclick="testArray([5, 3, 8, 6, 2, 7, 1, 4, 9])">测试数组 [5, 3, 8, 6, 2, 7, 1, 4, 9]</button>
            </div>
            
            <h3>区间修改测试</h3>
            <div class="controls">
                <input type="text" id="range-input" placeholder="输入范围，如: 2,4" style="padding: 8px; margin: 5px;">
                <input type="number" id="value-input" placeholder="修改值" style="padding: 8px; margin: 5px; width: 100px;">
                <button class="test-button" onclick="applyRangeModification()">应用区间修改</button>
            </div>
        </div>

        <main class="content">
            <div class="tree-container" id="tree-container">
                <!-- 线段树可视化将在这里显示 -->
            </div>
        </main>
    </div>

    <script src="js/generate_Visualizer_modify.js"></script>
    <script>
        let segmentTree;

        function testArray(array) {
            // 更新数组信息显示
            document.getElementById('array-info').textContent = `当前数组: [${array.join(', ')}]`;
            
            // 创建线段树并可视化
            segmentTree = new SegmentTree(array);
            visualizeTree();
            
            console.log('测试数组:', array);
            console.log('线段树大小:', segmentTree.tree.length);
        }

        function applyRangeModification() {
            if (!segmentTree) {
                alert('请先选择一个测试数组！');
                return;
            }

            const rangeInput = document.getElementById('range-input').value;
            const valueInput = document.getElementById('value-input').value;

            if (!rangeInput || !valueInput) {
                alert('请输入范围和修改值！');
                return;
            }

            try {
                const [left, right] = rangeInput.split(',').map(num => parseInt(num.trim()) - 1);
                const value = parseInt(valueInput);

                if (isNaN(left) || isNaN(right) || isNaN(value)) {
                    throw new Error('输入格式错误');
                }

                if (left < 0 || right >= segmentTree.n || left > right) {
                    throw new Error('范围超出数组边界');
                }

                // 应用区间修改
                segmentTree.updateRange(left, right, value);
                
                // 重新可视化
                visualizeTree();
                
                console.log(`应用区间修改: [${left + 1}, ${right + 1}] += ${value}`);
            } catch (error) {
                alert('输入错误: ' + error.message);
            }
        }

        // 初始化时显示一个默认数组
        window.onload = function() {
            testArray([1, 2, 3, 4, 5]);
        };
    </script>
</body>
</html>

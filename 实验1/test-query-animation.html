<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŸ¥è¯¢åŠ¨ç”»é€Ÿåº¦æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .control-panel { margin: 10px 0; }
        button { margin: 5px; padding: 10px 15px; }
        select { margin: 5px; padding: 5px; }
        .result { margin: 10px 0; padding: 10px; background: #f9f9f9; }
    </style>
</head>
<body>
    <h1>æŸ¥è¯¢åŠ¨ç”»é€Ÿåº¦æµ‹è¯•</h1>
    
    <div class="control-panel">
        <label>åŠ¨ç”»é€Ÿåº¦ï¼š</label>
        <select id="animation-speed" onchange="testAnimationSpeed()">
            <option value="slow">æ…¢é€Ÿ (1000ms)</option>
            <option value="normal" selected>æ­£å¸¸ (500ms)</option>
            <option value="fast">å¿«é€Ÿ (200ms)</option>
        </select>
    </div>

    <div class="control-panel">
        <button onclick="testGlobalVariable()">æµ‹è¯•å…¨å±€å˜é‡</button>
        <button onclick="testDelayFunctions()">æµ‹è¯•å»¶è¿Ÿå‡½æ•°</button>
        <button onclick="testEventBroadcast()">æµ‹è¯•äº‹ä»¶å¹¿æ’­</button>
    </div>

    <div id="test-results" class="result">
        æµ‹è¯•ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
    </div>

    <script>
        // æ¨¡æ‹Ÿè®¾ç½®åŠŸèƒ½çš„æ ¸å¿ƒéƒ¨åˆ†
        let animationSpeed = 'normal';
        
        // æ›´æ–°å…¨å±€å˜é‡
        function updateGlobalVars() {
            window.animationSpeed = animationSpeed;
        }
        
        // åˆå§‹åŒ–å…¨å±€å˜é‡
        updateGlobalVars();
        
        // æ¨¡æ‹ŸæŸ¥è¯¢æ¨¡å—çš„å»¶è¿Ÿå‡½æ•°
        function getAnimationDelay() {
            const animationSpeed = window.animationSpeed || 'normal';
            const speeds = { slow: 1000, normal: 500, fast: 200 };
            return speeds[animationSpeed] || 500;
        }

        function getBuildAnimationDelay() {
            const animationSpeed = window.animationSpeed || 'normal';
            const speeds = { slow: 200, normal: 100, fast: 50 };
            return speeds[animationSpeed] || 100;
        }
        
        // æµ‹è¯•å‡½æ•°
        function testAnimationSpeed() {
            const select = document.getElementById('animation-speed');
            animationSpeed = select.value;
            updateGlobalVars();
            
            // å¹¿æ’­äº‹ä»¶
            window.dispatchEvent(new CustomEvent('animationSpeedChanged', { 
                detail: { speed: animationSpeed } 
            }));
            
            logResult(`âœ… åŠ¨ç”»é€Ÿåº¦å·²æ›´æ”¹ä¸º: ${animationSpeed}`);
            logResult(`ğŸ”§ å½“å‰getAnimationDelay(): ${getAnimationDelay()}ms`);
            logResult(`ğŸ”§ å½“å‰getBuildAnimationDelay(): ${getBuildAnimationDelay()}ms`);
        }
        
        function testGlobalVariable() {
            logResult(`ğŸ“Š window.animationSpeed = ${window.animationSpeed}`);
            logResult(`ğŸ“Š æœ¬åœ° animationSpeed = ${animationSpeed}`);
        }
        
        function testDelayFunctions() {
            logResult(`â±ï¸ getAnimationDelay() = ${getAnimationDelay()}ms`);
            logResult(`â±ï¸ getBuildAnimationDelay() = ${getBuildAnimationDelay()}ms`);
        }
        
        function testEventBroadcast() {
            // ç›‘å¬äº‹ä»¶
            window.addEventListener('animationSpeedChanged', (event) => {
                logResult(`ğŸ¬ æ¥æ”¶åˆ°äº‹ä»¶: animationSpeedChanged, speed = ${event.detail.speed}`);
            });
            
            // å¹¿æ’­äº‹ä»¶
            window.dispatchEvent(new CustomEvent('animationSpeedChanged', { 
                detail: { speed: animationSpeed } 
            }));
        }
        
        function logResult(message) {
            const resultsDiv = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            resultsDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
        }
        
        // åˆå§‹æµ‹è¯•
        window.onload = function() {
            logResult('ğŸš€ æµ‹è¯•é¡µé¢å·²åŠ è½½');
            testGlobalVariable();
            testDelayFunctions();
        };
    </script>
</body>
</html>
